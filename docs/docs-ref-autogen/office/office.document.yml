### YamlMime:UniversalReference
ms.openlocfilehash: 80671c3c96e92a15b96379aa5f1474f0843451e0
ms.sourcegitcommit: beffe9455dace422e85b92f0105c54ff7b594cbf
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/20/2018
ms.locfileid: "24041796"
items:
- uid: office.Office.Document
  summary: <span data-ttu-id="f60c8-101">表示与外接程序交互的文档的抽象类。</span><span class="sxs-lookup"><span data-stu-id="f60c8-101">An abstract class that represents the document the add-in is interacting with.</span></span>
  remarks: <table><tr><td><span data-ttu-id="f60c8-102">主机</span><span class="sxs-lookup"><span data-stu-id="f60c8-102">Hosts</span></span></td><td><span data-ttu-id="f60c8-103">Access、Excel、PowerPoint、Project、Word</span><span class="sxs-lookup"><span data-stu-id="f60c8-103">Access, Excel, PowerPoint, Project, Word</span></span></td></tr></table>
  name: Office.Document
  fullName: office.Office.Document
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.Document.addHandlerAsync
  - office.Office.Document.bindings
  - office.Office.Document.customXmlParts
  - office.Office.Document.getActiveViewAsync
  - office.Office.Document.getFileAsync
  - office.Office.Document.getFilePropertiesAsync
  - office.Office.Document.getMaxResourceIndexAsync
  - office.Office.Document.getMaxTaskIndexAsync
  - office.Office.Document.getProjectFieldAsync
  - office.Office.Document.getResourceByIndexAsync
  - office.Office.Document.getResourceFieldAsync
  - office.Office.Document.getSelectedDataAsync
  - office.Office.Document.getSelectedResourceAsync
  - office.Office.Document.getSelectedTaskAsync
  - office.Office.Document.getSelectedViewAsync
  - office.Office.Document.getTaskAsync
  - office.Office.Document.getTaskByIndexAsync
  - office.Office.Document.getTaskFieldAsync
  - office.Office.Document.getWSSUrlAsync
  - office.Office.Document.goToByIdAsync
  - office.Office.Document.mode
  - office.Office.Document.removeHandlerAsync
  - office.Office.Document.setResourceFieldAsync
  - office.Office.Document.setSelectedDataAsync
  - office.Office.Document.setTaskFieldAsync
  - office.Office.Document.settings
  - office.Office.Document.url
- uid: office.Office.Document.addHandlerAsync
  summary: <span data-ttu-id="f60c8-104">添加 Document 对象事件的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f60c8-104">Adds an event handler for a Document object event.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"f60c8-105\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-105\">Requirement Sets</span></span></td><td><span data-ttu-id=\"f60c8-106\">DocumentEvents</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-106\">DocumentEvents</span></span></td></tr></table>\n\n<span data-ttu-id=\"f60c8-107\">只要每个事件处理程序函数的名称是唯一的您可以添加为指定的 eventType 的多个事件处理程序。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-107\">You can add multiple event handlers for the specified eventType as long as the name of each event handler function is unique.</span></span>\n\n<span data-ttu-id=\"f60c8-108\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-108\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p101\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p101\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-111\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-111\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-112\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-112\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-113\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-113\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-114\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-114\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-115\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-115\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-116\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-116\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"f60c8-117\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-117\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-118\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-118\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-119\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-119\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-120\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-120\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"f60c8-121\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-121\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-122\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-122\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-123\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-123\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-124\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-124\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-125\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-125\">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-126\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-126\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-127\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-127\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-128\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-128\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-129\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-129\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-130\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-130\">Examples</span></span>\n\n```javascript\n// The following example adds an event handler for the SelectionChanged event of a document\nfunction addSelectionChangedEventHandler() {\n    Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged, MyHandler);\n}\n\nfunction MyHandler(eventArgs) {\n    write('Event raised: ' + eventArgs.type);\n    doSomethingWithDocument(eventArgs.document);\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```\n```javascript\n// The following code example adds a handler for the ResourceSelectionChanged event.\n// When the resource selection changes in the document, it gets the GUID of the selected resource.\n// The example assumes your add-in has a reference to the jQuery library and that the\n// following page control is defined in the content div in the page body:\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            Office.context.document.addHandlerAsync(\n                Office.EventType.ResourceSelectionChanged,\n                getResourceGuid);\n        });\n    };\n\n    // Get the GUID of the selected resource and display it in the add-in.\n    function getResourceGuid() {\n        Office.context.document.getSelectedResourceAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    $('#message').html(result.value);\n                }\n            }\n        );\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n\n// For a complete code sample that shows how to use a ResourceSelectionChanged\n// event handler in a Project add-in, see \"Create your first task pane add-in\n// for Project 2013 by using a text editor.\"\n// https://docs.microsoft.com/office/dev/add-ins/project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor\n```\n```javascript\n// The following code example adds a handler for the TaskSelectionChanged event.\n// When the task selection changes in the document, it gets the GUID of the\n// selected task.\n// The example assumes your add-in has a reference to the jQuery library and that\n// the following page control is defined in the content div in the page body:\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            Office.context.document.addHandlerAsync(\n                Office.EventType.TaskSelectionChanged,\n                getTaskGuid);\n            getTaskGuid();\n        });\n    };\n\n    // Get the GUID of the selected task and display it in the add-in.\n    function getTaskGuid() {\n        Office.context.document.getSelectedTaskAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    $('#message').html(result.value);\n                }\n            }\n        );\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```\n```javascript\n// The following code example adds a handler for the ViewSelectionChanged\n// event. When the active view changes, it gets the name and type of the active view.\n// The example assumes your add-in has a reference to the jQuery library and that\n// the following page control is defined in the content div in the page body:\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            Office.context.document.addHandlerAsync(\n                Office.EventType.ViewSelectionChanged,\n                getActiveView);\n            getActiveView();\n        });\n    };\n\n    // Get the name and type of the active view and display it in the add-in.\n    function getActiveView() {\n        Office.context.document.getSelectedViewAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    var output = String.format(\n                        'View name: {0}<br/>View type: {1}',\n                        result.value.viewName, result.value.viewType);\n                    $('#message').html(output);\n                }\n            }\n        );\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n\n// For an example that shows how to use a ViewSelectionChanged event handler in a\n// Project add-in, see \"Create your first task pane add-in for Project 2013 by\n// using a text editor.\"\n// https://docs.microsoft.com/office/dev/add-ins/project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor\n```\n```javascript\n// The following code example uses addHandlerAsync to add an event handler for the ViewSelectionChanged event.\n// When the active view changes, the handler checks the view type. It enables a button if the view is a resource\n// view and disables the button if it isn't a resource view. Choosing the button gets the GUID of the selected\n// resource and displays it in the add-in.\n// The example assumes that your add-in has a reference to the jQuery library and that the following page controls\n// are defined in the content div in the page body:\n// <input id=\"get-info\" type=\"button\" value=\"Get info\" disabled=\"disabled\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            // Add a ViewSelectionChanged event handler.\n            Office.context.document.addHandlerAsync(\n                Office.EventType.ViewSelectionChanged,\n                getActiveView);\n            $('#get-info').click(getResourceGuid);\n\n            // This example calls the handler on page load to get the active view\n            // of the default page.\n            getActiveView();\n        });\n    };\n\n    // Activate the button based on the active view type of the document.\n    // This is the ViewSelectionChanged event handler.\n    function getActiveView() {\n        Office.context.document.getSelectedViewAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    var viewType = result.value.viewType;\n                    if (viewType == 6 ||   // ResourceForm\n                        viewType == 7 ||   // ResourceSheet\n                        viewType == 8 ||   // ResourceGraph\n                        viewType == 15) {  // ResourceUsage\n                        $('#get-info').removeAttr('disabled');\n                    }\n                    else {\n                        $('#get-info').attr('disabled', 'disabled');\n                    }\n                    var output = String.format(\n                        'View name: {0}<br/>View type: {1}',\n                        result.value.viewName, viewType);\n                    $('#message').html(output);\n                }\n            }\n        );\n    }\n\n    // Get the GUID of the currently selected resource and display it in the add-in.\n    function getResourceGuid() {\n        Office.context.document.getSelectedResourceAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    $('#message').html('Resource GUID: ' + result.value);\n                }\n            }\n        );\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n\n// For a complete code sample that shows how to use a ViewSelectionChanged event handler in a Project add-in,\n// see \"Create your first task pane add-in for Project by using a text editor.\"\n// https://docs.microsoft.com/office/dev/add-ins/project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor\n```"
  name: addHandlerAsync(eventType, handler, options, callback)
  fullName: office.Office.Document.addHandlerAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'addHandlerAsync(eventType: Office.EventType, handler: any, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: <span data-ttu-id="f60c8-131">对于 Document 对象事件，eventType 参数可以指定为`Office.EventType.Document.SelectionChanged`或`Office.EventType.Document.ActiveViewChanged`，或此枚举的对应文本值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-131">For a Document object event, the eventType parameter can be specified as `Office.EventType.Document.SelectionChanged` or `Office.EventType.Document.ActiveViewChanged`, or the corresponding text value of this enumeration.</span></span>
      type:
      - Office.EventType
    - id: handler
      description: <span data-ttu-id="f60c8-132">事件处理程序函数添加，其唯一参数是类型[Office.DocumentSelectionChangedEventArgs](xref:office.Office.DocumentSelectionChangedEventArgs)的<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-132">The event handler function to add, whose only parameter is of type[Office.DocumentSelectionChangedEventArgs](xref:office.Office.DocumentSelectionChangedEventArgs)<!-- -->.</span></span> <span data-ttu-id="f60c8-133">必需。</span><span class="sxs-lookup"><span data-stu-id="f60c8-133">Required.</span></span>
      type:
      - any
    - id: options
      description: <span data-ttu-id="f60c8-134">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-134">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-135">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-135">Optional.</span></span> <span data-ttu-id="f60c8-136">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-136">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Document.bindings
  summary: <span data-ttu-id="f60c8-137">获取提供对文档中定义的绑定的访问的对象。</span><span class="sxs-lookup"><span data-stu-id="f60c8-137">Gets an object that provides access to the bindings defined in the document.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-138\">您不直接在脚本中实例化 Document 对象。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-138\">You don't instantiate the Document object directly in your script.</span></span> <span data-ttu-id=\"f60c8-139\">要呼叫的 Document 对象的成员与当前文档或工作表进行交互，请使用`Office.context.document`在脚本中。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-139\">To call members of the Document object to interact with the current document or worksheet, use `Office.context.document` in your script.</span></span>\n\n<span data-ttu-id=\"f60c8-140\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-140\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p105\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此属性。空的单元格表示相应的 Office 主机应用程序不支持此属性。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p105\">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>\n\n<span data-ttu-id=\"f60c8-143\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-143\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-144\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-144\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-145\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-145\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-146\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-146\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-147\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-147\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-148\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-148\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"f60c8-149\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-149\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-150\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-150\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"f60c8-151\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-151\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-152\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-152\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-153\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-153\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-154\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-154\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-155\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-155\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-156\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-156\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-157\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-157\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-158\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-158\">Examples</span></span>\n\n```javascript\nfunction displayAllBindings() {\n    Office.context.document.bindings.getAllAsync(function (asyncResult) {\n        var bindingString = '';\n        for (var i in asyncResult.value) {\n            bindingString += asyncResult.value[i].id + '\\n';\n        }\n        write('Existing bindings: ' + bindingString);\n    });\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: bindings
  fullName: office.Office.Document.bindings
  langs:
  - typeScript
  type: property
  syntax:
    content: 'bindings: Bindings;'
    return:
      type:
      - office.Office.Bindings
- uid: office.Office.Document.customXmlParts
  summary: <span data-ttu-id="f60c8-159">获取文档中表示自定义 XML 部件的对象。</span><span class="sxs-lookup"><span data-stu-id="f60c8-159">Gets an object that represents the custom XML parts in the document.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-160\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-160\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p106\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此属性。空的单元格表示相应的 Office 主机应用程序不支持此属性。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p106\">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>\n\n<span data-ttu-id=\"f60c8-163\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-163\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-164\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-164\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-165\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-165\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-166\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-166\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-167\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-167\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-168\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-168\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-169\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-169\">Y</span></span> </td><td> </td><td> <span data-ttu-id=\"f60c8-170\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-170\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-171\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-171\">Examples</span></span>\n\n```javascript\nfunction getCustomXmlParts(){\n    Office.context.document.customXmlParts.getByNamespaceAsync('http://tempuri.org', function (asyncResult) {\n        write('Retrieved ' + asyncResult.value.length + ' custom XML parts');\n    });\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: customXmlParts
  fullName: office.Office.Document.customXmlParts
  langs:
  - typeScript
  type: property
  syntax:
    content: 'customXmlParts: CustomXmlParts;'
    return:
      type:
      - office.Office.CustomXmlParts
- uid: office.Office.Document.getActiveViewAsync
  summary: <span data-ttu-id="f60c8-172">返回演示文稿（编辑或读取）的当前视图的状态。</span><span class="sxs-lookup"><span data-stu-id="f60c8-172">Returns the state of the current view of the presentation (edit or read).</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="f60c8-173">要求集</span><span class="sxs-lookup"><span data-stu-id="f60c8-173">Requirement Sets</span></span></td><td><span data-ttu-id="f60c8-174">ActiveView</span><span class="sxs-lookup"><span data-stu-id="f60c8-174">ActiveView</span></span></td></tr></table>


    <span data-ttu-id="f60c8-175">当视图更改时可以触发事件。</span><span class="sxs-lookup"><span data-stu-id="f60c8-175">Can trigger an event when the view changes.</span></span>


    <span data-ttu-id="f60c8-176">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-176">**Support details**</span></span>


    <span data-ttu-id="f60c8-p107">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p107">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-179">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-179">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-180">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-180">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-181">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-181">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-182">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-182">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="f60c8-183">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="f60c8-183">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="f60c8-184"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-184"><strong> Excel </strong></span></span></td><td> </td><td> </td><td> <span data-ttu-id="f60c8-185">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-185">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-186"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-186"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="f60c8-187">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-187">Y</span></span> </td><td> <span data-ttu-id="f60c8-188">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-188">Y</span></span> </td><td> <span data-ttu-id="f60c8-189">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-189">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-190"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-190"><strong> Word </strong></span></span></td><td> </td><td> </td><td> <span data-ttu-id="f60c8-191">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-191">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-192">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-192">Examples</span></span>


    ```javascript

    function getFileView() {
        // Get whether the current view is edit or read.
        Office.context.document.getActiveViewAsync(function (asyncResult) {
            if (asyncResult.status == "failed") {
                showMessage("Action failed with error: " + asyncResult.error.message);
            }
            else {
                showMessage(asyncResult.value);
            }
        });
    }

    ```
  name: getActiveViewAsync(options, callback)
  fullName: office.Office.Document.getActiveViewAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getActiveViewAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<"edit" | "read">) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-193">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-193">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-194">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-194">Optional.</span></span> <span data-ttu-id="f60c8-195">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-195">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-196">`value`结果属性是演示文稿的当前视图的状态。</span><span class="sxs-lookup"><span data-stu-id="f60c8-196">The `value` property of the result is the state of the presentation's current view.</span></span> <span data-ttu-id="f60c8-197">可以在"编辑"读取"，则返回的值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-197">The value returned can be either "edit" or "read".</span></span> <span data-ttu-id="f60c8-198">"编辑"对应于任何可在其中编辑幻灯片，如普通或大纲视图的视图。</span><span class="sxs-lookup"><span data-stu-id="f60c8-198">"edit" corresponds to any of the views in which you can edit slides, such as Normal or Outline View.</span></span> <span data-ttu-id="f60c8-199">"读取"对应于幻灯片放映或阅读视图。</span><span class="sxs-lookup"><span data-stu-id="f60c8-199">"read" corresponds to either Slide Show or Reading View.</span></span>
      type:
      - '(result: AsyncResult<"edit" | "read">) => void'
- uid: office.Office.Document.getFileAsync
  summary: <span data-ttu-id="f60c8-200">以高达 4194304 字节 (4 MB) 的切片形式返回整个文档文件。</span><span class="sxs-lookup"><span data-stu-id="f60c8-200">Returns the entire document file in slices of up to 4194304 bytes (4 MB).</span></span> <span data-ttu-id="f60c8-201">对于 iOS 加载项而言，支持高达 65536 (64 KB) 的文件切片。</span><span class="sxs-lookup"><span data-stu-id="f60c8-201">For add-ins for iOS, file slice is supported up to 65536 (64 KB).</span></span> <span data-ttu-id="f60c8-202">请注意，如果指定文件切片的大小上限超出允许限制，则会导致一个“内部错误”故障。</span><span class="sxs-lookup"><span data-stu-id="f60c8-202">Note that specifying file slice size of above permitted limit will result in an "Internal Error" failure.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"f60c8-203\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-203\">Requirement Sets</span></span></td><td><span data-ttu-id=\"f60c8-204\">文件</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-204\">File</span></span></td></tr></table>\n\n<span data-ttu-id=\"f60c8-205\">加载项运行的 Office 主机应用程序之外 Office iOS getFileAsync 方法支持获取文件切块达 4194304 字节 (4 MB)。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-205\">For add-ins running in Office host applications other than Office for iOS, the getFileAsync method supports getting files in slices of up to 4194304 bytes (4 MB).</span></span> <span data-ttu-id=\"f60c8-206\">对于运行在 Office for iOS 应用中的加载项，getFileAsync 方法支持以切片形式获取至多 65536 (64 KB) 的文件。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-206\">For add-ins running in Office for iOS apps, the getFileAsync method supports getting files in slices of up to 65536 (64 KB).</span></span>\n\n<span data-ttu-id=\"f60c8-207\">FileType 参数可以指定使用[Office.FileType](xref:office.Office.FileType)枚举或文本值。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-207\">The fileType parameter can be specified by using the [Office.FileType](xref:office.Office.FileType) enumeration or text values.</span></span> <span data-ttu-id=\"f60c8-208\">但的可能值随主机：</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-208\">But the possible values vary with the host:</span></span>\n\n<span data-ttu-id=\"f60c8-209\">Excel Online、 Win32、 Mac 和 iOS:`Office.FileType.Compressed`</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-209\">Excel Online, Win32, Mac, and iOS: `Office.FileType.Compressed`</span></span>\n\n<span data-ttu-id=\"f60c8-210\">Windows 桌面、 Mac 和 iPad，以及 PowerPoint Online PowerPoint: `Office.FileType.Compressed`，`Office.FileType.Pdf`</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-210\">PowerPoint on Windows desktop, Mac, and iPad, and PowerPoint Online: `Office.FileType.Compressed`, `Office.FileType.Pdf`</span></span>\n\n<span data-ttu-id=\"f60c8-211\">在 Windows 桌面上，Word Mac，在 word 和 Word Online: `Office.FileType.Compressed`， `Office.FileType.Pdf`，`Office.FileType.Text`</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-211\">Word on Windows desktop, Word on Mac, and Word Online: `Office.FileType.Compressed`, `Office.FileType.Pdf`, `Office.FileType.Text`</span></span>\n\n<span data-ttu-id=\"f60c8-212\">在 iPad 上的 Word: `Office.FileType.Compressed`，`Office.FileType.Text`</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-212\">Word on iPad: `Office.FileType.Compressed`, `Office.FileType.Text`</span></span>\n\n<span data-ttu-id=\"f60c8-213\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-213\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p112\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p112\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-216\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-216\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-217\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-217\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-218\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-218\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-219\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-219\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-220\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-220\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-221\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-221\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"f60c8-222\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-222\">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-223\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-223\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"f60c8-224\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-224\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-225\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-225\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-226\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-226\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-227\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-227\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-228\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-228\">Y</span></span> </td><td> </td><td> <span data-ttu-id=\"f60c8-229\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-229\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-230\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-230\">Examples</span></span>\n\n```javascript\n// The following example gets the document in Office Open XML (\"compressed\") format in 65536 bytes (64 KB) slices.\n// Note: The implementation of app.showNotification in this example is from the Visual Studio template for Office Add-ins.\nfunction getDocumentAsCompressed() {\n    Office.context.document.getFileAsync(Office.FileType.Compressed, { sliceSize: 65536 /*64 KB*/ }, \n        function (result) {\n            if (result.status == \"succeeded\") {\n            // If the getFileAsync call succeeded, then\n            // result.value will return a valid File Object.\n            var myFile = result.value;\n            var sliceCount = myFile.sliceCount;\n            var slicesReceived = 0, gotAllSlices = true, docdataSlices = [];\n            app.showNotification(\"File size:\" + myFile.size + \" #Slices: \" + sliceCount);\n\n            // Get the file slices.\n            getSliceAsync(myFile, 0, sliceCount, gotAllSlices, docdataSlices, slicesReceived);\n            }\n            else {\n            app.showNotification(\"Error:\", result.error.message);\n            }\n    });\n}\n\nfunction getSliceAsync(file, nextSlice, sliceCount, gotAllSlices, docdataSlices, slicesReceived) {\n    file.getSliceAsync(nextSlice, function (sliceResult) {\n        if (sliceResult.status == \"succeeded\") {\n            if (!gotAllSlices) { // Failed to get all slices, no need to continue.\n                return;\n            }\n\n            // Got one slice, store it in a temporary array.\n            // (Or you can do something else, such as\n            // send it to a third-party server.)\n            docdataSlices[sliceResult.value.index] = sliceResult.value.data;\n            if (++slicesReceived == sliceCount) {\n              // All slices have been received.\n              file.closeAsync();\n              onGotAllSlices(docdataSlices);\n            }\n            else {\n                getSliceAsync(file, ++nextSlice, sliceCount, gotAllSlices, docdataSlices, slicesReceived);\n            }\n        }\n            else {\n                gotAllSlices = false;\n                file.closeAsync();\n                app.showNotification(\"getSliceAsync Error:\", sliceResult.error.message);\n            }\n    });\n}\n\nfunction onGotAllSlices(docdataSlices) {\n    var docdata = [];\n    for (var i = 0; i < docdataSlices.length; i++) {\n        docdata = docdata.concat(docdataSlices[i]);\n    }\n\n    var fileContent = new String();\n    for (var j = 0; j < docdata.length; j++) {\n        fileContent += String.fromCharCode(docdata[j]);\n    }\n\n    // Now all the file content is stored in 'fileContent' variable,\n    // you can do something with it, such as print, fax...\n}\n\n// The following example gets the document in PDF format.\nOffice.context.document.getFileAsync(Office.FileType.Pdf,\n    function(result) {\n        if (result.status == \"succeeded\") {\n            var myFile = result.value;\n            var sliceCount = myFile.sliceCount;\n            app.showNotification(\"File size:\" + myFile.size + \" #Slices: \" + sliceCount);\n            // Now, you can call getSliceAsync to download the files,\n            // as described in the previous code segment (compressed format).\n            \n            myFile.closeAsync();\n        }\n        else {\n            app.showNotification(\"Error:\", result.error.message);\n        }\n}\n);\n```"
  name: getFileAsync(fileType, options, callback)
  fullName: office.Office.Document.getFileAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getFileAsync(fileType: FileType, options?: GetFileOptions, callback?: (result: AsyncResult<Office.File>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: fileType
      description: <span data-ttu-id="f60c8-231">将在其中返回文件的格式</span><span class="sxs-lookup"><span data-stu-id="f60c8-231">The format in which the file will be returned</span></span>
      type:
      - office.Office.FileType
    - id: options
      description: <span data-ttu-id="f60c8-232">提供用于设置的文档分为的切片大小选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-232">Provides options for setting the size of slices that the document will be divided into.</span></span>
      type:
      - office.Office.GetFileOptions
    - id: callback
      description: <span data-ttu-id="f60c8-233">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-233">Optional.</span></span> <span data-ttu-id="f60c8-234">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-234">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-235">`value`属性的结果是 File 对象。</span><span class="sxs-lookup"><span data-stu-id="f60c8-235">The `value` property of the result is the File object.</span></span>
      type:
      - '(result: AsyncResult<Office.File>) => void'
- uid: office.Office.Document.getFilePropertiesAsync
  summary: <span data-ttu-id="f60c8-236">获取当前文档的文件属性。</span><span class="sxs-lookup"><span data-stu-id="f60c8-236">Gets file properties of the current document.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="f60c8-237">要求集</span><span class="sxs-lookup"><span data-stu-id="f60c8-237">Requirement Sets</span></span></td><td><span data-ttu-id="f60c8-238">不在集合中</span><span class="sxs-lookup"><span data-stu-id="f60c8-238">Not in a set</span></span></td></tr></table>


    <span data-ttu-id="f60c8-239">获取与 url 属性的文件的 URL `asyncResult.value.url`。</span><span class="sxs-lookup"><span data-stu-id="f60c8-239">You get the file's URL with the url property `asyncResult.value.url`.</span></span>


    <span data-ttu-id="f60c8-240">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-240">**Support details**</span></span>


    <span data-ttu-id="f60c8-p114">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p114">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-243">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-243">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-244">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-244">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-245">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-245">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-246">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-246">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="f60c8-247">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="f60c8-247">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="f60c8-248"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-248"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="f60c8-249">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-249">Y</span></span> </td><td> <span data-ttu-id="f60c8-250">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-250">Y</span></span> </td><td> <span data-ttu-id="f60c8-251">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-251">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-252"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-252"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="f60c8-253">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-253">Y</span></span> </td><td> <span data-ttu-id="f60c8-254">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-254">Y</span></span> </td><td> <span data-ttu-id="f60c8-255">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-255">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-256"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-256"><strong> Word </strong></span></span></td><td> <span data-ttu-id="f60c8-257">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-257">Y</span></span> </td><td> <span data-ttu-id="f60c8-258">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-258">Y</span></span> </td><td> <span data-ttu-id="f60c8-259">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-259">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-260">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-260">Examples</span></span>


    ```javascript

    // To read the URL of the current file, you need to write a callback function that returns the URL.

    // The following example shows how to:

    // 1. Pass an anonymous callback function that returns the value of the file's URL

    //    to the callback parameter of the getFilePropertiesAsync method.

    // 2. Display the value on the add-in's page.

    function getFileUrl() {
        // Get the URL of the current file.
        Office.context.document.getFilePropertiesAsync(function (asyncResult) {
            var fileUrl = asyncResult.value.url;
            if (fileUrl == "") {
                showMessage("The file hasn't been saved yet. Save the file and try again");
            }
            else {
                showMessage(fileUrl);
            }
        });
    }

    ```
  name: getFilePropertiesAsync(options, callback)
  fullName: office.Office.Document.getFilePropertiesAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getFilePropertiesAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<Office.FileProperties>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-261">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-261">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-262">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-262">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-263">`value`结果属性是文件的属性 (在以下位置找到的 url `asyncResult.value.url`)。</span><span class="sxs-lookup"><span data-stu-id="f60c8-263">The `value` property of the result is the file's properties (with the URL found at `asyncResult.value.url`).</span></span>
      type:
      - '(result: AsyncResult<Office.FileProperties>) => void'
- uid: office.Office.Document.getMaxResourceIndexAsync
  summary: >-
    <span data-ttu-id="f60c8-264">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-264">Project documents only.</span></span> <span data-ttu-id="f60c8-265">获取当前项目中的最大资源的集合的索引。</span><span class="sxs-lookup"><span data-stu-id="f60c8-265">Get the maximum index of the collection of resources in the current project.</span></span>


    <span data-ttu-id="f60c8-266">重要说明：此 API 仅可在 Windows 桌面上的 Project 2016 中运行。</span><span class="sxs-lookup"><span data-stu-id="f60c8-266">Important: This API works only in Project 2016 on Windows desktop.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-267\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-267\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p117\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p117\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-270\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-270\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-271\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-271\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-272\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-272\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-273\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-273\">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id=\"f60c8-274\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-274\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-275\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-275\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-276\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-276\">Examples</span></span>\n\n```javascript\n// The following code example calls getResourceTaskIndexAsync to get the maximum index of the collection \n// of resources in the current project. Then it uses the returned value and the getResourceByIndexAsync\n// method to get each resource GUID. The example assumes that your add-in has a reference to the \n// jQuery library and that the following page controls are defined in the content div in the page body:\n// <input id=\"get-info\" type=\"button\" value=\"Get info\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n    var resourceGuids = ;\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            app.initialize();\n            $('#get-info').click(getResourceInfo);\n        });\n    };\n\n    // Get the maximum resource index, and then get the resource GUIDs.\n    function getResourceInfo() {\n        getMaxResourceIndex().then(\n            function (data) {\n                getResourceGuids(data);\n            }\n        );\n    }\n\n    // Get the maximum index of the resources for the current project.\n    function getMaxResourceIndex() {\n        var defer = $.Deferred();\n        Office.context.document.getMaxResourceIndexAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    defer.resolve(result.value);\n                }\n            }\n        );\n        return defer.promise();\n    }\n\n    // Get each resource GUID, and then display the GUIDs in the add-in.\n    // There is no 0 index for resources, so start with index 1.\n    function getResourceGuids(maxResourceIndex) {\n        var defer = $.Deferred();\n        for (var i = 1; i <= maxResourceIndex; i++) {\n            getResourceGuid(i);\n        }\n        return defer.promise();\n        function getResourceGuid(index) {\n            Office.context.document.getResourceByIndexAsync(index,\n                function (result) {\n                    if (result.status === Office.AsyncResultStatus.Succeeded) {\n                        resourceGuids.push(result.value);\n                        if (index == maxResourceIndex) {\n                            defer.resolve();\n                            $('#message').html(resourceGuids.toString());\n                        }\n                    }\n                    else {\n                        onError(result.error);\n                    }\n                }\n            );\n        }\n    }\n    function onError(error) {\n        app.showNotification(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: getMaxResourceIndexAsync(options, callback)
  fullName: office.Office.Document.getMaxResourceIndexAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getMaxResourceIndexAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<number>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-277">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-277">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-278">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-278">Optional.</span></span> <span data-ttu-id="f60c8-279">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-279">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-280">`value`结果属性是当前项目的资源集合中的最高的索引号。</span><span class="sxs-lookup"><span data-stu-id="f60c8-280">The `value` property of the result is the highest index number in the current project's resource collection.</span></span>
      type:
      - '(result: AsyncResult<number>) => void'
- uid: office.Office.Document.getMaxTaskIndexAsync
  summary: >-
    <span data-ttu-id="f60c8-281">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-281">Project documents only.</span></span> <span data-ttu-id="f60c8-282">获取当前项目中任务的集合的最大索引。</span><span class="sxs-lookup"><span data-stu-id="f60c8-282">Get the maximum index of the collection of tasks in the current project.</span></span>


    <span data-ttu-id="f60c8-283">重要说明：此 API 仅可在 Windows 桌面上的 Project 2016 中运行。</span><span class="sxs-lookup"><span data-stu-id="f60c8-283">Important: This API works only in Project 2016 on Windows desktop.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-284">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-284">**Support details**</span></span>


    <span data-ttu-id="f60c8-p120">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p120">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-287">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-287">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-288">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-288">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-289">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-289">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-290">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-290">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id="f60c8-291"><strong>项目</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-291"><strong> Project </strong></span></span></td><td> <span data-ttu-id="f60c8-292">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-292">Y</span></span> </td><td> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-293">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-293">Examples</span></span>


    ```javascript

    // The following code example calls getMaxTaskIndexAsync to get the maximum index

    // of the collection of tasks in the current project. Then it uses the returned value

    // with the getTaskByIndexAsync method to get each task GUID.

    // The example assumes your add-in has a reference to the jQuery library and that the

    // following page controls are defined in the content div in the page body:

    // <input id="get-info" type="button" value="Get info" /><br />

    // <span id="message"></span>


    (function () {
        "use strict";
        var taskGuids = ;

        // The initialize function must be run each time a new page is loaded.
        Office.initialize = function (reason) {
            $(document).ready(function () {

                // After the DOM is loaded, add-in-specific code can run.
                app.initialize();
                $('#get-info').click(getTaskInfo);
            });
        };

        // Get the maximum task index, and then get the task GUIDs.
        function getTaskInfo() {
            getMaxTaskIndex().then(
                function (data) {
                    getTaskGuids(data);
                }
            );
        }

        // Get the maximum index of the tasks for the current project.
        function getMaxTaskIndex() {
            var defer = $.Deferred();
            Office.context.document.getMaxTaskIndexAsync(
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        defer.resolve(result.value);
                    }
                }
            );
            return defer.promise();
        }

        // Get each task GUID, and then display the GUIDs in the add-in.
        function getTaskGuids(maxTaskIndex) {
            var defer = $.Deferred();
            for (var i = 0; i <= maxTaskIndex; i++) {
                getTaskGuid(i);
            }
            return defer.promise();
            function getTaskGuid(index) {
                Office.context.document.getTaskByIndexAsync(index,
                    function (result) {
                        if (result.status === Office.AsyncResultStatus.Succeeded) {
                            taskGuids.push(result.value);
                            if (index == maxTaskIndex) {
                                defer.resolve();
                                $('#message').html(taskGuids.toString());
                            }
                        }
                        else {
                            onError(result.error);
                        }
                    }
                );
            }
        }
        function onError(error) {
            app.showNotification(error.name + ' ' + error.code + ': ' + error.message);
        }
    })();

    ```
  name: getMaxTaskIndexAsync(options, callback)
  fullName: office.Office.Document.getMaxTaskIndexAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getMaxTaskIndexAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<number>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-294">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-294">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-295">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-295">Optional.</span></span> <span data-ttu-id="f60c8-296">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-296">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-297">`value`结果属性是当前项目的任务集合中的最高的索引号。</span><span class="sxs-lookup"><span data-stu-id="f60c8-297">The `value` property of the result is the highest index number in the current project's task collection.</span></span>
      type:
      - '(result: AsyncResult<number>) => void'
- uid: office.Office.Document.getProjectFieldAsync
  summary: <span data-ttu-id="f60c8-298">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-298">Project documents only.</span></span> <span data-ttu-id="f60c8-299">获取项目字段 （例如</span><span class="sxs-lookup"><span data-stu-id="f60c8-299">Get Project field (Ex.</span></span> <span data-ttu-id="f60c8-300">ProjectWebAccessURL)。</span><span class="sxs-lookup"><span data-stu-id="f60c8-300">ProjectWebAccessURL).</span></span>
  remarks: "<span data-ttu-id=\"f60c8-301\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-301\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p123\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p123\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-304\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-304\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-305\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-305\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-306\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-306\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-307\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-307\">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id=\"f60c8-308\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-308\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-309\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-309\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-310\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-310\">Examples</span></span>\n\n```javascript\n// The following code example gets the values of three specified fields for the active project, \n// and then displays the values in the add-in.\n// The example calls getProjectFieldAsync recursively, after the previous call returns successfully.\n// It also tracks the calls to determine when all calls are sent.\n// The example assumes your add-in has a reference to the jQuery library and that the \n// following page control is defined in the content div in the page body:\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // Get information for the active project.\n            getProjectInformation();\n        });\n    };\n\n    // Get the specified fields for the active project.\n    function getProjectInformation() {\n        var fields =\n            [Office.ProjectProjectFields.Start, \n             Office.ProjectProjectFields.Finish, \n             Office.ProjectProjectFields.GUID];\n        var fieldValues = ['Start: ', 'Finish: ', 'GUID: '];\n        var index = 0; \n        getField();\n\n        // Get each field, and then display the field values in the add-in.\n        function getField() {\n            if (index == fields.length) {\n                var output = '';\n                for (var i = 0; i < fieldValues.length; i++) {\n                    output += fieldValues[i] + '<br />';\n                }\n                $('#message').html(output);\n            }\n            else {\n                Office.context.document.getProjectFieldAsync(\n                    fields[index],\n                    function (result) {\n\n                        // If the call is successful, get the field value and then get the next field.\n                        if (result.status === Office.AsyncResultStatus.Succeeded) {\n                            fieldValues[index] += result.value.fieldValue;\n                            getField(index++);\n                        }\n                        else {\n                            onError(result.error);\n                        }\n                    }\n                );\n            }\n        }\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: getProjectFieldAsync(fieldId, options, callback)
  fullName: office.Office.Document.getProjectFieldAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getProjectFieldAsync(fieldId: number, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<any>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: fieldId
      description: <span data-ttu-id="f60c8-311">项目级别的域。</span><span class="sxs-lookup"><span data-stu-id="f60c8-311">Project level fields.</span></span>
      type:
      - number
    - id: options
      description: <span data-ttu-id="f60c8-312">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-312">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-313">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-313">Optional.</span></span> <span data-ttu-id="f60c8-314">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-314">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-315">`value`属性结果包含`fieldValue`属性，它代表指定字段的值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-315">The `value` property of the result contains the `fieldValue` property, which represents the value of the specified field.</span></span>
      type:
      - '(result: AsyncResult<any>) => void'
- uid: office.Office.Document.getResourceByIndexAsync
  summary: >-
    <span data-ttu-id="f60c8-316">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-316">Project documents only.</span></span> <span data-ttu-id="f60c8-317">获取具有指定的索引资源集合中的资源的 GUID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-317">Get the GUID of the resource that has the specified index in the resource collection.</span></span>


    <span data-ttu-id="f60c8-318">重要说明：此 API 仅可在 Windows 桌面上的 Project 2016 中运行。</span><span class="sxs-lookup"><span data-stu-id="f60c8-318">Important: This API works only in Project 2016 on Windows desktop.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-319\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-319\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p126\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p126\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-322\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-322\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-323\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-323\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-324\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-324\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-325\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-325\">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id=\"f60c8-326\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-326\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-327\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-327\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-328\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-328\">Examples</span></span>\n\n```javascript\n// The following code example calls getMaxResourceIndexAsync to get the maximum index in the project's resource\n// collection, and then calls getResourceByIndexAsync to get the GUID for each resource.\n// The example assumes that your add-in has a reference to the jQuery library and that the following \n// page controls are defined in the content div in the page body:\n// <input id=\"get-info\" type=\"button\" value=\"Get info\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n    var resourceGuids = ;\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            app.initialize();\n            $('#get-info').click(getResourceInfo);\n        });\n    };\n\n    // Get the maximum resource index, and then get the resource GUIDs.\n    function getResourceInfo() {\n        getMaxResourceIndex().then(\n            function (data) {\n                getResourceGuids(data);\n            }\n        );\n    }\n\n    // Get the maximum index of the resources for the current project.\n    function getMaxResourceIndex() {\n        var defer = $.Deferred();\n        Office.context.document.getMaxResourceIndexAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    defer.resolve(result.value);\n                }\n            }\n        );\n        return defer.promise();\n    }\n\n    // Get each resource GUID, and then display the GUIDs in the add-in.\n    // There is no 0 index for resources, so start with index 1.\n    function getResourceGuids(maxResourceIndex) {\n        var defer = $.Deferred();\n        for (var i = 1; i <= maxResourceIndex; i++) {\n            getResourceGuid(i);\n        }\n        return defer.promise();\n        function getResourceGuid(index) {\n            Office.context.document.getResourceByIndexAsync(index,\n                function (result) {\n                    if (result.status === Office.AsyncResultStatus.Succeeded) {\n                        resourceGuids.push(result.value);\n                        if (index == maxResourceIndex) {\n                            defer.resolve();\n                            $('#message').html(resourceGuids.toString());\n                        }\n                    }\n                    else {\n                        onError(result.error);\n                    }\n                }\n            );\n        }\n    }\n    function onError(error) {\n        app.showNotification(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: getResourceByIndexAsync(resourceIndex, options, callback)
  fullName: office.Office.Document.getResourceByIndexAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getResourceByIndexAsync(resourceIndex: number, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: resourceIndex
      description: <span data-ttu-id="f60c8-329">项目的资源集合中的资源索引。</span><span class="sxs-lookup"><span data-stu-id="f60c8-329">The index of the resource in the collection of resources for the project.</span></span>
      type:
      - number
    - id: options
      description: <span data-ttu-id="f60c8-330">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-330">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-331">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-331">Optional.</span></span> <span data-ttu-id="f60c8-332">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-332">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-333">`value`结果属性是字符串形式的资源的 GUID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-333">The `value` property of the result is the GUID of the resource as a string.</span></span>
      type:
      - '(result: AsyncResult<string>) => void'
- uid: office.Office.Document.getResourceFieldAsync
  summary: <span data-ttu-id="f60c8-334">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-334">Project documents only.</span></span> <span data-ttu-id="f60c8-335">资源域获得提供的资源 id (Ex.ResourceName)。</span><span class="sxs-lookup"><span data-stu-id="f60c8-335">Get resource field for provided resource Id. (Ex.ResourceName)</span></span>
  remarks: "<span data-ttu-id=\"f60c8-336\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-336\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p129\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p129\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-339\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-339\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-340\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-340\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-341\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-341\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-342\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-342\">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id=\"f60c8-343\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-343\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-344\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-344\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-345\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-345\">Examples</span></span>\n\n```javascript\n// The following code example calls getSelectedResourceAsync to get the GUID of the resource\n// that's currently selected in a resource view. Then it gets three resource field values by calling \n// getResourceFieldAsync recursively.\n// The example assumes your add-in has a reference to the jQuery library and that the following \n// page controls are defined in the content div in the page body:\n// <input id=\"get-info\" type=\"button\" value=\"Get info\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            $('#get-info').click(getResourceInfo);\n        });\n    };\n\n    // Get the GUID of the resource and then get the resource fields.\n    function getResourceInfo() {\n        getResourceGuid().then(\n            function (data) {\n                getResourceFields(data);\n            }\n        );\n    }\n\n    // Get the GUID of the selected resource.\n    function getResourceGuid() {\n        var defer = $.Deferred();\n        Office.context.document.getSelectedResourceAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    defer.resolve(result.value);\n                }\n            }\n        );\n        return defer.promise();\n    }\n\n    // Get the specified fields for the selected resource.\n    function getResourceFields(resourceGuid) {\n        var targetFields =\n            [Office.ProjectResourceFields.Name,\n             Office.ProjectResourceFields.Units, \n             Office.ProjectResourceFields.BaseCalendar];\n        var fieldValues = ['Name: ', 'Units: ', 'Base calendar: '];\n        var index = 0; \n        getField();\n\n        // Get each field, and then display the field values in the add-in.\n        function getField() {\n            if (index == targetFields.length) {\n                var output = '';\n                for (var i = 0; i < fieldValues.length; i++) {\n                    output += fieldValues[i] + '<br />';\n                }\n                $('#message').html(output);\n            }\n\n            // If the call is successful, get the field value and then get the next field.\n            else {\n                Office.context.document.getResourceFieldAsync(\n                    resourceGuid,\n                    targetFields[index],\n                    function (result) {\n                        if (result.status === Office.AsyncResultStatus.Succeeded) {\n                            fieldValues[index] += result.value.fieldValue;\n                            getField(index++);\n                        }\n                        else {\n                            onError(result.error);\n                        }\n                    }\n                );\n            }\n        }\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: getResourceFieldAsync(resourceId, fieldId, options, callback)
  fullName: office.Office.Document.getResourceFieldAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getResourceFieldAsync(resourceId: string, fieldId: number, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: resourceId
      description: <span data-ttu-id="f60c8-346">字符串或资源 id 值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-346">Either a string or value of the Resource Id.</span></span>
      type:
      - string
    - id: fieldId
      description: <span data-ttu-id="f60c8-347">资源字段。</span><span class="sxs-lookup"><span data-stu-id="f60c8-347">Resource Fields.</span></span>
      type:
      - number
    - id: options
      description: <span data-ttu-id="f60c8-348">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-348">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-349">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-349">Optional.</span></span> <span data-ttu-id="f60c8-350">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-350">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-351">`value`结果属性是字符串形式的资源的 GUID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-351">The `value` property of the result is the GUID of the resource as a string.</span></span>
      type:
      - '(result: AsyncResult<string>) => void'
- uid: office.Office.Document.getSelectedDataAsync
  summary: <span data-ttu-id="f60c8-352">读取包含在文档的当前选择中的数据。</span><span class="sxs-lookup"><span data-stu-id="f60c8-352">Reads the data contained in the current selection in the document.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"f60c8-353\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-353\">Requirement Sets</span></span></td><td><span data-ttu-id=\"f60c8-354\">Selection</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-354\">Selection</span></span></td></tr></table>\n\n<span data-ttu-id=\"f60c8-355\">在传递给 getSelectedDataAsync 方法的回调函数，您可以使用 AsyncResult 对象的属性返回以下信息。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-355\">In the callback function that is passed to the getSelectedDataAsync method, you can use the properties of the AsyncResult object to return the following information.</span></span>\n\n<table> <tr> <th><span data-ttu-id=\"f60c8-356\">属性</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-356\">Property</span></span></th> <th><span data-ttu-id=\"f60c8-357\">用于...</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-357\">Use to...</span></span></th> </tr> <tr> <td><span data-ttu-id=\"f60c8-358\">AsyncResult.value</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-358\">AsyncResult.value</span></span></td> <td><span data-ttu-id=\"f60c8-359\">始终返回 undefined，因为没有要检索数据或对象。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-359\">Always returns undefined because there is no object or data to retrieve.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-360\">AsyncResult.status</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-360\">AsyncResult.status</span></span></td> <td><span data-ttu-id=\"f60c8-361\">确定操作是成功还是失败。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-361\">Determine the success or failure of the operation.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-362\">AsyncResult.error</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-362\">AsyncResult.error</span></span></td> <td><span data-ttu-id=\"f60c8-363\">如果操作失败，则访问提供错误信息的 Error 对象。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-363\">Access an Error object that provides error information if the operation failed.</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-364\">AsyncResult.asyncContext</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-364\">AsyncResult.asyncContext</span></span></td> <td><span data-ttu-id=\"f60c8-365\">在 AsyncResult 对象中未经改动的返回的任何类型的用户定义项。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-365\">A user-defined item of any type that is returned in the AsyncResult object without being altered.</span></span></td> </tr> </table>\n\n<span data-ttu-id=\"f60c8-366\">[Office.CoercionType](xref:office.Office.CoercionType)参数的可能值随主机。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-366\">The possible values for the [Office.CoercionType](xref:office.Office.CoercionType) parameter vary by the host.</span></span>\n\n<table> <tr> <th><span data-ttu-id=\"f60c8-367\">Host</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-367\">Host</span></span></th> <th><span data-ttu-id=\"f60c8-368\">支持的 coercionType</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-368\">Supported coercionType</span></span></th> </tr> <tr> <td><span data-ttu-id=\"f60c8-369\">Excel、 联机 Excel、 PowerPoint、 联机 PowerPoint、 Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-369\">Excel, Excel Online, PowerPoint, PowerPoint Online, Word, and Word Online</span></span></td> <td><span data-ttu-id=\"f60c8-370\">`Office.CoercionType.Text`（字符串）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-370\">`Office.CoercionType.Text` (string)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-371\">Excel、 Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-371\">Excel, Word, and Word Online</span></span></td> <td><span data-ttu-id=\"f60c8-372\">`Office.CoercionType.Matrix`（数组的数组）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-372\">`Office.CoercionType.Matrix` (array of arrays)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-373\">Access、 Excel、 Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-373\">Access, Excel, Word, and Word Online</span></span></td> <td><span data-ttu-id=\"f60c8-374\">`Office.CoercionType.Table`（TableData 对象）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-374\">`Office.CoercionType.Table` (TableData object)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-375\">Word</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-375\">Word</span></span></td> <td>`Office.CoercionType.Html`</td> </tr> <tr> <td><span data-ttu-id=\"f60c8-376\">Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-376\">Word and Word Online</span></span> </td> <td><span data-ttu-id=\"f60c8-377\">`Office.CoercionType.Ooxml`(Office Open XML)</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-377\">`Office.CoercionType.Ooxml` (Office Open XML)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-378\">PowerPoint 和 PowerPoint Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-378\">PowerPoint and PowerPoint Online</span></span></td> <td>`Office.CoercionType.SlideRange`</td> </tr> </table>\n\n<span data-ttu-id=\"f60c8-379\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-379\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p131\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p131\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-382\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-382\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-383\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-383\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-384\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-384\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-385\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-385\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-386\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-386\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-387\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-387\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"f60c8-388\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-388\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-389\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-389\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"f60c8-390\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-390\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-391\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-391\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-392\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-392\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-393\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-393\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"f60c8-394\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-394\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-395\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-395\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-396\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-396\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-397\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-397\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-398\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-398\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-399\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-399\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-400\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-400\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-401\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-401\">Y</span></span> </td><td> </td><td> <span data-ttu-id=\"f60c8-402\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-402\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-403\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-403\">Examples</span></span>\n\n```javascript\n// The following example uses the getSelectedDataAsync method of the Document object to retrieve the\n// user's current selection as text, and then display it in the add-in's page.\n\n// Display the user's current selection.\nfunction showSelection() {\n    Office.context.document.getSelectedDataAsync(\n        \"text\",                        // coercionType\n        {valueFormat: \"unformatted\",   // valueFormat\n        filterType: \"all\"},            // filterType\n        function (result) {            // callback\n            var dataValue; \n            dataValue = result.value;\n            write('Selected data is: ' + dataValue);\n        });\n}\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```\n```javascript\n// To read the value of the current selection, you need to write a callback function that reads the selection.\n// The following example shows how to:\n// 1. Pass an anonymous callback function that reads the value of the current selection\n//    to the callback parameter of the getSelectedDataAsync method.\n// 2. Read the selection as text, unformatted, and not filtered.\n// 3. Display the value on the add-in's page.\nfunction getText() {\n    Office.context.document.getSelectedDataAsync(Office.CoercionType.Text, \n        { valueFormat: \"unformatted\", filterType: \"all\" },\n        function (asyncResult) {\n            var error = asyncResult.error;\n            if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n                write(error.name + \": \" + error.message);\n            } \n            else {\n                // Get selected data.\n                var dataValue = asyncResult.value; \n                write('Selected data is ' + dataValue);\n            }            \n        });\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```\n```javascript\n// The following code example gets the values of the selected cells. It uses the optional\n// asyncContext parameter to pass some text to the callback function.\n// The example assumes your add-in has a reference to the jQuery library and that the\n// following page controls are defined in the content div in the page body:\n// <input id=\"get-info\" type=\"button\" value=\"Get info\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            $('#get-info').click(getSelectedText);\n        });\n    };\n\n    // Get the text from the selected cells in the document, and display it in the add-in.\n    function getSelectedText() {\n        Office.context.document.getSelectedDataAsync(\n            Office.CoercionType.Text,\n            {asyncContext: 'Some related info'},\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    var output = String.format(\n                        'Selected text: {0}<br/>Passed info: {1}',\n                        result.value, result.asyncContext);\n                    $('#message').html(output);\n                }\n            }\n        );\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: getSelectedDataAsync(coerciontype, options, callback)
  fullName: office.Office.Document.getSelectedDataAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getSelectedDataAsync<T>(coerciontype: Office.CoercionType, options?: GetSelectedDataOptions, callback?: (result: AsyncResult<T>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: coerciontype
      description: ''
      type:
      - office.Office.CoercionType
    - id: options
      description: <span data-ttu-id="f60c8-404">提供用于自定义将返回哪些数据和格式选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-404">Provides options for customizing what data is returned and how it is formatted.</span></span>
      type:
      - office.Office.GetSelectedDataOptions
    - id: callback
      description: <span data-ttu-id="f60c8-405">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-405">Optional.</span></span> <span data-ttu-id="f60c8-406">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-406">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-407">`value`结果属性是当前选定内容中的数据。</span><span class="sxs-lookup"><span data-stu-id="f60c8-407">The `value` property of the result is the data in the current selection.</span></span> <span data-ttu-id="f60c8-408">这返回的数据结构或使用 coercionType 参数指定的格式。</span><span class="sxs-lookup"><span data-stu-id="f60c8-408">This is returned in the data structure or format you specified with the coercionType parameter.</span></span> <span data-ttu-id="f60c8-409">（请参阅备注，了解有关数据强制的详细信息。）</span><span class="sxs-lookup"><span data-stu-id="f60c8-409">(See Remarks for more information about data coercion.)</span></span>
      type:
      - '(result: AsyncResult<T>) => void'
- uid: office.Office.Document.getSelectedResourceAsync
  summary: <span data-ttu-id="f60c8-410">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-410">Project documents only.</span></span> <span data-ttu-id="f60c8-411">获取当前所选的资源的 id。</span><span class="sxs-lookup"><span data-stu-id="f60c8-411">Get the current selected Resource's Id.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-412\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-412\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p134\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p134\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-415\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-415\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-416\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-416\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-417\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-417\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-418\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-418\">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id=\"f60c8-419\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-419\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-420\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-420\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-421\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-421\">Examples</span></span>\n\n```javascript\n// The following code example calls getSelectedResourceAsync to get the GUID of the resource that's \n// currently selected in a resource view. Then it gets three resource field values by calling \n// getResourceFieldAsync recursively.\n// The example assumes your add-in has a reference to the jQuery library and that the following page controls are\n// defined in the content div in the page body:\n// <input id=\"get-info\" type=\"button\" value=\"Get info\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // After the DOM is loaded, add-in-specific code can run.\n            $('#get-info').click(getResourceInfo);\n        });\n    };\n\n    // Get the GUID of the resource and then get the resource fields.\n    function getResourceInfo() {\n        getResourceGuid().then(\n            function (data) {\n                getResourceFields(data);\n            }\n        );\n    }\n\n    // Get the GUID of the selected resource.\n    function getResourceGuid() {\n        var defer = $.Deferred();\n        Office.context.document.getSelectedResourceAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    defer.resolve(result.value);\n                }\n            }\n        );\n        return defer.promise();\n    }\n\n    // Get the specified fields for the selected resource.\n    function getResourceFields(resourceGuid) {\n        var targetFields =\n            [Office.ProjectResourceFields.Name,\n             Office.ProjectResourceFields.Units, \n             Office.ProjectResourceFields.BaseCalendar];\n        var fieldValues = ['Name: ', 'Units: ', 'Base calendar: '];\n        var index = 0; \n        getField();\n\n        // Get each field, and then display the field values in the add-in.\n        function getField() {\n            if (index == targetFields.length) {\n                var output = '';\n                for (var i = 0; i < fieldValues.length; i++) {\n                    output += fieldValues[i] + '<br />';\n                }\n                $('#message').html(output);\n            }\n\n            // If the call is successful, get the field value and then get the next field.\n            else {\n                Office.context.document.getResourceFieldAsync(\n                    resourceGuid,\n                    targetFields[index],\n                    function (result) {\n                        if (result.status === Office.AsyncResultStatus.Succeeded) {\n                            fieldValues[index] += result.value.fieldValue;\n                            getField(index++);\n                        }\n                        else {\n                            onError(result.error);\n                        }\n                    }\n                );\n            }\n        }\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: getSelectedResourceAsync(options, callback)
  fullName: office.Office.Document.getSelectedResourceAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getSelectedResourceAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-422">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-422">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-423">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-423">Optional.</span></span> <span data-ttu-id="f60c8-424">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-424">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-425">`value`结果属性是字符串形式的资源的 GUID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-425">The `value` property of the result is the GUID of the resource as a string.</span></span>
      type:
      - '(result: AsyncResult<string>) => void'
- uid: office.Office.Document.getSelectedTaskAsync
  summary: <span data-ttu-id="f60c8-426">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-426">Project documents only.</span></span> <span data-ttu-id="f60c8-427">获取当前所选的任务的 id。</span><span class="sxs-lookup"><span data-stu-id="f60c8-427">Get the current selected Task's Id.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-428">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-428">**Support details**</span></span>


    <span data-ttu-id="f60c8-p137">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p137">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-431">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-431">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-432">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-432">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-433">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-433">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-434">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-434">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id="f60c8-435"><strong>项目</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-435"><strong> Project </strong></span></span></td><td> <span data-ttu-id="f60c8-436">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-436">Y</span></span> </td><td> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-437">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-437">Examples</span></span>


    ```javascript

    // The following code example calls getSelectedTaskAsync to get the GUID of the task that's currently

    // selected in a task view. Then it gets task properties by calling getTaskAsync.

    // The example assumes your add-in has a reference to the jQuery library and that the following page

    // controls are defined in the content div in the page body:

    // <input id="get-info" type="button" value="Get info" /><br />

    // <span id="message"></span>


    (function () {
        "use strict";

        // The initialize function must be run each time a new page is loaded.
        Office.initialize = function (reason) {
            $(document).ready(function () {

                // After the DOM is loaded, add-in-specific code can run.
                $('#get-info').click(getTaskInfo);
            });
        };

        // // Get the GUID of the task, and then get local task properties.
        function getTaskInfo() {
            getTaskGuid().then(
                function (data) {
                    getTaskProperties(data);
                }
            );
        }

        // Get the GUID of the selected task.
        function getTaskGuid() {
            var defer = $.Deferred();
            Office.context.document.getSelectedTaskAsync(
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        defer.resolve(result.value);
                    }
                }
            );
            return defer.promise();
        }

        // Get local properties for the selected task, and then display it in the add-in.
        function getTaskProperties(taskGuid) {
            Office.context.document.getTaskAsync(
                taskGuid,
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        var taskInfo = result.value;
                        var output = String.format(
                            'Name: {0}<br/>GUID: {1}<br/>SharePoint task ID: {2}<br/>Resource names: {3}',
                            taskInfo.taskName, taskGuid, taskInfo.wssTaskId, taskInfo.resourceNames);
                        $('#message').html(output);
                    }
                }
            );
        }

        function onError(error) {
            $('#message').html(error.name + ' ' + error.code + ': ' + error.message);
        }
    })();

    ```
  name: getSelectedTaskAsync(options, callback)
  fullName: office.Office.Document.getSelectedTaskAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getSelectedTaskAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-438">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-438">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-439">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-439">Optional.</span></span> <span data-ttu-id="f60c8-440">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-440">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-441">`value`结果属性是字符串形式的资源的 GUID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-441">The `value` property of the result is the GUID of the resource as a string.</span></span>
      type:
      - '(result: AsyncResult<string>) => void'
- uid: office.Office.Document.getSelectedViewAsync
  summary: <span data-ttu-id="f60c8-442">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-442">Project documents only.</span></span> <span data-ttu-id="f60c8-443">获取当前所选的视图类型 （例如</span><span class="sxs-lookup"><span data-stu-id="f60c8-443">Get the current selected View Type (Ex.</span></span> <span data-ttu-id="f60c8-444">甘特条形） 和查看名称。</span><span class="sxs-lookup"><span data-stu-id="f60c8-444">Gantt) and View Name.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-445">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-445">**Support details**</span></span>


    <span data-ttu-id="f60c8-p140">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p140">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-448">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-448">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-449">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-449">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-450">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-450">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-451">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-451">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id="f60c8-452"><strong>项目</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-452"><strong> Project </strong></span></span></td><td> <span data-ttu-id="f60c8-453">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-453">Y</span></span> </td><td> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-454">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-454">Examples</span></span>


    ```javascript

    // The following code example calls adds a ViewSelectionChanged event handler that

    // calls getSelectedViewAsync to get the name and type of the active view in the document.

    // The example assumes your add-in has a reference to the jQuery library and that

    // the following page control is defined in the content div in the page body:

    // <span id="message"></span>


    (function () {
        "use strict";

        // The initialize function must be run each time a new page is loaded.
        Office.initialize = function (reason) {
            $(document).ready(function () {

                // After the DOM is loaded, add-in-specific code can run.
                Office.context.document.addHandlerAsync(
                    Office.EventType.ViewSelectionChanged,
                    getActiveView);
                getActiveView();
            });
        };

        // Get the active view's name and type.
        function getActiveView() {
            Office.context.document.getSelectedViewAsync(
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        var output = String.format(
                            'View name: {0}<br/>View type: {1}',
                            result.value.viewName, viewType);
                        $('#message').html(output);
                    }
                }
            );
        }

        function onError(error) {
            $('#message').html(error.name + ' ' + error.code + ': ' + error.message);
        }
    })();

    ```
  name: getSelectedViewAsync(options, callback)
  fullName: office.Office.Document.getSelectedViewAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getSelectedViewAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<any>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-455">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-455">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: '<span data-ttu-id="f60c8-456">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-456">Optional.</span></span> <span data-ttu-id="f60c8-457">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-457">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-458">`value`结果属性包含以下属性： `viewName` -视图，作为 ProjectViewTypes 常量的名称。</span><span class="sxs-lookup"><span data-stu-id="f60c8-458">The `value` property of the result contains the following properties: `viewName` - The name of the view, as a ProjectViewTypes constant.</span></span> <span data-ttu-id="f60c8-459">`viewType`-视图，作为整数值的 ProjectViewTypes 常量的类型。</span><span class="sxs-lookup"><span data-stu-id="f60c8-459">`viewType` - The type of view, as the integer value of a ProjectViewTypes constant.</span></span>'
      type:
      - '(result: AsyncResult<any>) => void'
- uid: office.Office.Document.getTaskAsync
  summary: <span data-ttu-id="f60c8-460">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-460">Project documents only.</span></span> <span data-ttu-id="f60c8-461">获取任务名称、 WSS 任务 Id 和 ResourceNames 的给定 taskId。</span><span class="sxs-lookup"><span data-stu-id="f60c8-461">Get the Task Name, WSS Task Id, and ResourceNames for given taskId.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-462">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-462">**Support details**</span></span>


    <span data-ttu-id="f60c8-p143">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p143">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-465">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-465">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-466">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-466">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-467">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-467">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-468">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-468">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id="f60c8-469"><strong>项目</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-469"><strong> Project </strong></span></span></td><td> <span data-ttu-id="f60c8-470">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-470">Y</span></span> </td><td> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-471">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-471">Examples</span></span>


    ```javascript

    // The following code example calls getSelectedTaskAsync to get the task GUID of the currently

    // selected task. Then it calls getTaskAsync to get the properties for the task that are

    // available from the JavaScript API for Office.

    // The example assumes your add-in has a reference to the jQuery library and that the

    // following page controls are defined in the content div in the page body:

    // <input id="get-info" type="button" value="Get info" /><br />

    // <span id="message"></span>


    (function () {
        "use strict";

        // The initialize function must be run each time a new page is loaded.
        Office.initialize = function (reason) {
            $(document).ready(function () {

                // After the DOM is loaded, add-in-specific code can run.
                $('#get-info').click(getTaskInfo);
            });
        };

        // Get the GUID of the task, and then get local task properties.
        function getTaskInfo() {
            getTaskGuid().then(
                function (data) {
                    getTaskProperties(data);
                }
            );
        }

        // Get the GUID of the selected task.
        function getTaskGuid() {
            var defer = $.Deferred();
            Office.context.document.getSelectedTaskAsync(
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        defer.resolve(result.value);
                    }
                }
            );
            return defer.promise();
        }

        // Get local properties for the selected task, and then display it in the add-in.
        function getTaskProperties(taskGuid) {
            Office.context.document.getTaskAsync(
                taskGuid,
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        var taskInfo = result.value;
                        var output = String.format(
                            'Name: {0}<br/>GUID: {1}<br/>SharePoint task ID: {2}<br/>Resource names: {3}',
                            taskInfo.taskName, taskGuid, taskInfo.wssTaskId, taskInfo.resourceNames);
                        $('#message').html(output);
                    }
                }
            );
        }

        function onError(error) {
            $('#message').html(error.name + ' ' + error.code + ': ' + error.message);
        }
    })();

    ```
  name: getTaskAsync(taskId, options, callback)
  fullName: office.Office.Document.getTaskAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getTaskAsync(taskId: string, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<any>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: taskId
      description: <span data-ttu-id="f60c8-472">字符串或任务 id 值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-472">Either a string or value of the Task Id.</span></span>
      type:
      - string
    - id: options
      description: <span data-ttu-id="f60c8-473">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-473">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: '<span data-ttu-id="f60c8-474">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-474">Optional.</span></span> <span data-ttu-id="f60c8-475">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-475">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-476">`value`结果属性包含以下属性： `taskName` -任务的名称。</span><span class="sxs-lookup"><span data-stu-id="f60c8-476">The `value` property of the result contains the following properties: `taskName` - The name of the task.</span></span> <span data-ttu-id="f60c8-477">`wssTaskId`的同步 SharePoint 任务列表中的任务 ID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-477">`wssTaskId` - The ID of the task in the synchronized SharePoint task list.</span></span> <span data-ttu-id="f60c8-478">如果项目未与 SharePoint 任务列表同步，则值为 0。</span><span class="sxs-lookup"><span data-stu-id="f60c8-478">If the project is not synchronized with a SharePoint task list, the value is 0.</span></span> <span data-ttu-id="f60c8-479">`resourceNames`-逗号分隔的分配给任务的资源的名称列表。</span><span class="sxs-lookup"><span data-stu-id="f60c8-479">`resourceNames` - The comma-separated list of the names of resources that are assigned to the task.</span></span>'
      type:
      - '(result: AsyncResult<any>) => void'
- uid: office.Office.Document.getTaskByIndexAsync
  summary: >-
    <span data-ttu-id="f60c8-480">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-480">Project documents only.</span></span> <span data-ttu-id="f60c8-481">获取具有指定的索引任务集合中的任务的 GUID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-481">Get the GUID of the task that has the specified index in the task collection.</span></span>


    <span data-ttu-id="f60c8-482">重要说明：此 API 仅可在 Windows 桌面上的 Project 2016 中运行。</span><span class="sxs-lookup"><span data-stu-id="f60c8-482">Important: This API works only in Project 2016 on Windows desktop.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-483">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-483">**Support details**</span></span>


    <span data-ttu-id="f60c8-p146">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p146">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-486">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-486">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-487">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-487">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-488">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-488">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-489">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-489">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id="f60c8-490"><strong>项目</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-490"><strong> Project </strong></span></span></td><td> <span data-ttu-id="f60c8-491">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-491">Y</span></span> </td><td> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-492">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-492">Examples</span></span>


    ```javascript

    // The following code example calls getMaxTaskIndexAsync to get the

    // maximum index in the project's task collection, and then

    // calls getTaskByIndexAsync to get the GUID for each task.

    // The example assumes that your add-in has a reference to the

    // jQuery library and that the following page controls are defined

    // in the content div in the page body:

    // <input id="get-info" type="button" value="Get info" /><br />

    // <span id="message"></span>


    (function () {
        "use strict";
        var taskGuids = ;

        // The initialize function must be run each time a new page is loaded.
        Office.initialize = function (reason) {
            $(document).ready(function () {

                // After the DOM is loaded, add-in-specific code can run.
                app.initialize();
                $('#get-info').click(getTaskInfo);
            });
        };

        // Get the maximum task index, and then get the task GUIDs.
        function getTaskInfo() {
            getMaxTaskIndex().then(
                function (data) {
                    getTaskGuids(data);
                }
            );
        }

        // Get the maximum index of the tasks for the current project.
        function getMaxTaskIndex() {
            var defer = $.Deferred();
            Office.context.document.getMaxTaskIndexAsync(
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        defer.resolve(result.value);
                    }
                }
            );
            return defer.promise();
        }

        // Get each task GUID, and then display the GUIDs in the add-in.
        function getTaskGuids(maxTaskIndex) {
            var defer = $.Deferred();
            for (var i = 0; i <= maxTaskIndex; i++) {
                getTaskGuid(i);
            }
            return defer.promise();
            function getTaskGuid(index) {
                Office.context.document.getTaskByIndexAsync(index,
                    function (result) {
                        if (result.status === Office.AsyncResultStatus.Succeeded) {
                            taskGuids.push(result.value);
                            if (index == maxTaskIndex) {
                                defer.resolve();
                                $('#message').html(taskGuids.toString());
                            }
                        }
                        else {
                            onError(result.error);
                        }
                    }
                );
            }
        }
        function onError(error) {
            app.showNotification(error.name + ' ' + error.code + ': ' + error.message);
        }
    })();

    ```
  name: getTaskByIndexAsync(taskIndex, options, callback)
  fullName: office.Office.Document.getTaskByIndexAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getTaskByIndexAsync(taskIndex: number, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: taskIndex
      description: <span data-ttu-id="f60c8-493">项目的任务集合中的任务索引。</span><span class="sxs-lookup"><span data-stu-id="f60c8-493">The index of the task in the collection of tasks for the project.</span></span>
      type:
      - number
    - id: options
      description: <span data-ttu-id="f60c8-494">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-494">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-495">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-495">Optional.</span></span> <span data-ttu-id="f60c8-496">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-496">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-497">`value`结果属性是字符串形式的任务的 GUID。</span><span class="sxs-lookup"><span data-stu-id="f60c8-497">The `value` property of the result is the GUID of the task as a string.</span></span>
      type:
      - '(result: AsyncResult<string>) => void'
- uid: office.Office.Document.getTaskFieldAsync
  summary: <span data-ttu-id="f60c8-498">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-498">Project documents only.</span></span> <span data-ttu-id="f60c8-499">任务域获得提供的任务 id （例如。</span><span class="sxs-lookup"><span data-stu-id="f60c8-499">Get task field for provided task Id. (Ex.</span></span> <span data-ttu-id="f60c8-500">StartDate)。</span><span class="sxs-lookup"><span data-stu-id="f60c8-500">StartDate).</span></span>
  remarks: "<span data-ttu-id=\"f60c8-501\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-501\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p149\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p149\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-504\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-504\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-505\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-505\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-506\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-506\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-507\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-507\">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id=\"f60c8-508\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-508\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-509\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-509\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-510\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-510\">Examples</span></span>\n\n```javascript\n// The following code example calls getSelectedTaskAsync to get the GUID of the task that's currently\n// selected in a task view. Then it gets two task field values by calling getTaskFieldAsync recursively.\n// The example assumes your add-in has a reference to the jQuery library and that the following page\n// controls are defined in the content div in the page body:\n// <input id=\"get-info\" type=\"button\" value=\"Get info\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n            \n            // After the DOM is loaded, add-in-specific code can run.\n            $('#get-info').click(getTaskInfo);\n        });\n    };\n\n    // Get the GUID of the task, and then get the task fields.\n    function getTaskInfo() {\n        getTaskGuid().then(\n            function (data) {\n                getTaskFields(data);\n            }\n        );\n    }\n\n    // Get the GUID of the selected task.\n    function getTaskGuid() {\n        var defer = $.Deferred();\n        Office.context.document.getSelectedTaskAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    defer.resolve(result.value);\n                }\n            }\n        );\n        return defer.promise();\n    }\n\n    // Get the specified fields for the selected task.\n    function getTaskFields(taskGuid) {\n        var output = '';\n        var targetFields = [Office.ProjectTaskFields.Priority, Office.ProjectTaskFields.PercentComplete];\n        var fieldValues = ['Priority: ', '% Complete: '];\n        var index = 0;\n        getField();\n\n        // Get each field, and then display the field values in the add-in.\n        function getField() {\n            if (index == targetFields.length) {\n                for (var i = 0; i < fieldValues.length; i++) {\n                    output += fieldValues[i] + '<br />';\n                }\n                $('#message').html(output);\n            }\n\n            // Get the field value. If the call is successful, then get the next field.\n            else {\n                Office.context.document.getTaskFieldAsync(\n                    taskGuid,\n                    targetFields[index],\n                    function (result) {\n                        if (result.status === Office.AsyncResultStatus.Succeeded) {\n                            fieldValues[index] += result.value.fieldValue;\n                            getField(index++);\n                        }\n                        else {\n                            onError(result.error);\n                        }\n                    }\n                );\n            }\n        }\n    }\n\n    function onError(error) {\n        $('#message').html(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: getTaskFieldAsync(taskId, fieldId, options, callback)
  fullName: office.Office.Document.getTaskFieldAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getTaskFieldAsync(taskId: string, fieldId: number, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<any>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: taskId
      description: <span data-ttu-id="f60c8-511">字符串或任务 id 值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-511">Either a string or value of the Task Id.</span></span>
      type:
      - string
    - id: fieldId
      description: <span data-ttu-id="f60c8-512">任务域。</span><span class="sxs-lookup"><span data-stu-id="f60c8-512">Task Fields.</span></span>
      type:
      - number
    - id: options
      description: <span data-ttu-id="f60c8-513">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-513">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-514">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-514">Optional.</span></span> <span data-ttu-id="f60c8-515">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-515">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-516">`value`属性结果包含`fieldValue`属性，它代表指定字段的值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-516">The `value` property of the result contains the `fieldValue` property, which represents the value of the specified field.</span></span>
      type:
      - '(result: AsyncResult<any>) => void'
- uid: office.Office.Document.getWSSUrlAsync
  summary: <span data-ttu-id="f60c8-517">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-517">Project documents only.</span></span> <span data-ttu-id="f60c8-518">获取任务列表的 WSS Url 和列表名称，MPP 太同步。</span><span class="sxs-lookup"><span data-stu-id="f60c8-518">Get the WSS Url and list name for the Tasks List, the MPP is synced too.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-519">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-519">**Support details**</span></span>


    <span data-ttu-id="f60c8-p152">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p152">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-522">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-522">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-523">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-523">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-524">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-524">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-525">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-525">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id="f60c8-526"><strong>项目</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-526"><strong> Project </strong></span></span></td><td> <span data-ttu-id="f60c8-527">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-527">Y</span></span> </td><td> </td></tr> </table>
  name: getWSSUrlAsync(options, callback)
  fullName: office.Office.Document.getWSSUrlAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getWSSUrlAsync(options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<any>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: <span data-ttu-id="f60c8-528">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-528">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: '<span data-ttu-id="f60c8-529">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-529">Optional.</span></span> <span data-ttu-id="f60c8-530">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-530">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-531">`value`结果属性包含以下属性： `listName` -同步 SharePoint 任务列表的名称。</span><span class="sxs-lookup"><span data-stu-id="f60c8-531">The `value` property of the result contains the following properties: `listName` - the name of the synchronized SharePoint task list.</span></span> <span data-ttu-id="f60c8-532">`serverUrl`-同步 SharePoint 任务列表的 URL。</span><span class="sxs-lookup"><span data-stu-id="f60c8-532">`serverUrl` - the URL of the synchronized SharePoint task list.</span></span>'
      type:
      - '(result: AsyncResult<any>) => void'
- uid: office.Office.Document.goToByIdAsync
  summary: <span data-ttu-id="f60c8-533">转到文档中指定的对象或位置。</span><span class="sxs-lookup"><span data-stu-id="f60c8-533">Goes to the specified object or location in the document.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="f60c8-534">要求集</span><span class="sxs-lookup"><span data-stu-id="f60c8-534">Requirement Sets</span></span></td><td><span data-ttu-id="f60c8-535">不在集合中</span><span class="sxs-lookup"><span data-stu-id="f60c8-535">not in a set</span></span></td></tr></table>


    <span data-ttu-id="f60c8-536">PowerPoint 不支持母版视图中的 goToByIdAsync 方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-536">PowerPoint doesn't support the goToByIdAsync method in Master Views.</span></span>


    <span data-ttu-id="f60c8-537">导致 selectionMode 选项的行为随主机：</span><span class="sxs-lookup"><span data-stu-id="f60c8-537">The behavior caused by the selectionMode option varies by host:</span></span>


    <span data-ttu-id="f60c8-538">在 Excel:`Office.SelectionMode.Selected`选择中的绑定或命名项的所有内容。</span><span class="sxs-lookup"><span data-stu-id="f60c8-538">In Excel: `Office.SelectionMode.Selected` selects all content in the binding, or named item.</span></span> <span data-ttu-id="f60c8-539">Office.SelectionMode.None 对于文本绑定，选择单元格；对于矩阵绑定、表绑定和已命名的项目，选择第一个数据单元格（不是表格标题行中的第一个单元格）。</span><span class="sxs-lookup"><span data-stu-id="f60c8-539">Office.SelectionMode.None for text bindings, selects the cell; for matrix bindings, table bindings, and named items, selects the first data cell (not first cell in header row for tables).</span></span>


    <span data-ttu-id="f60c8-540">在 PowerPoint 中：`Office.SelectionMode.Selected`选定的幻灯片标题或第一张幻灯片上的 textbox。</span><span class="sxs-lookup"><span data-stu-id="f60c8-540">In PowerPoint: `Office.SelectionMode.Selected` selects the slide title or first textbox on the slide.</span></span> <span data-ttu-id="f60c8-541">`Office.SelectionMode.None`不能选择任何内容。</span><span class="sxs-lookup"><span data-stu-id="f60c8-541">`Office.SelectionMode.None` doesn't select anything.</span></span>


    <span data-ttu-id="f60c8-542">在 Word:`Office.SelectionMode.Selected`绑定中选择的所有内容。</span><span class="sxs-lookup"><span data-stu-id="f60c8-542">In Word: `Office.SelectionMode.Selected` selects all content in the binding.</span></span> <span data-ttu-id="f60c8-543">Office.SelectionMode.None 对于文本绑定，将光标移到文本开头；对于矩阵绑定和表绑定，选择第一个数据单元格（不是表格标题行中的第一个单元格）。</span><span class="sxs-lookup"><span data-stu-id="f60c8-543">Office.SelectionMode.None for text bindings, moves the cursor to the beginning of the text; for matrix bindings and table bindings, selects the first data cell (not first cell in header row for tables).</span></span>


    <span data-ttu-id="f60c8-544">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-544">**Support details**</span></span>


    <span data-ttu-id="f60c8-p157">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p157">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-547">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-547">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-548">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-548">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-549">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-549">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-550">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-550">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="f60c8-551">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="f60c8-551">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="f60c8-552"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-552"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="f60c8-553">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-553">Y</span></span> </td><td> <span data-ttu-id="f60c8-554">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-554">Y</span></span> </td><td> <span data-ttu-id="f60c8-555">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-555">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-556"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-556"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="f60c8-557">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-557">Y</span></span> </td><td> <span data-ttu-id="f60c8-558">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-558">Y</span></span> </td><td> <span data-ttu-id="f60c8-559">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-559">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-560"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-560"><strong> Word </strong></span></span></td><td> <span data-ttu-id="f60c8-561">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-561">Y</span></span> </td><td> </td><td> <span data-ttu-id="f60c8-562">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-562">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-563">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-563">Examples</span></span>


    ```javascript

    // Go to a binding by id (Word and Excel)

    // The following example shows how to:

    // 1. Create a table binding using the addFromSelectionAsync method as a sample binding to work with.

    // 2. Specify that binding as the binding to go to.

    // 3. Pass an anonymous callback function that returns the status of the operation

    //    to the callback parameter of the goToByIdAsync method.

    // 4. Display the value on the add-in's page.

    function gotoBinding() {
        // Create a new table binding for the selected table.
        Office.context.document.bindings.addFromSelectionAsync("table",{ id: "MyTableBinding" }, function (asyncResult) {
        if (asyncResult.status == "failed") {
                  showMessage("Action failed with error: " + asyncResult.error.message);
              }
              else {
                  showMessage("Added new binding with type: " + asyncResult.value.type +" and id: " + asyncResult.value.id);
              }
        });

        // Go to binding by id.
        Office.context.document.goToByIdAsync("MyTableBinding", Office.GoToType.Binding, function (asyncResult) {
            if (asyncResult.status == "failed") {
                showMessage("Action failed with error: " + asyncResult.error.message);
            }
            else {
                showMessage("Navigation successful");
            }
        });
    }


    // Go to a table in a spreadsheet (Excel)

    // The following example shows how to:

    // 1. Specify a table by name as the table to go to.

    // 2. Pass an anonymous callback function that returns the status of the operation

    //    to the callback parameter of the goToByIdAsync method.

    // 3. Display the value on the add-in's page.

    function goToTable() {
        Office.context.document.goToByIdAsync("Table1", Office.GoToType.NamedItem, function (asyncResult) {
            if (asyncResult.status == "failed") {
                showMessage("Action failed with error: " + asyncResult.error.message);
            }
            else {
                showMessage("Navigation successful");
            }
        });
    }


    // Go to the currently selected slide by id (PowerPoint)

    // The following example shows how to:

    // 1. Get the id of the currently selected slides using the getSelectedDataAsync method.

    // 2. Specify the returned id as the slide to go to.

    // 3. Pass an anonymous callback function that returns the status of the operation

    //    to the callback parameter of the goToByIdAsync method.

    // 4. Display the value of the stringified JSON object returned by asyncResult.value,

    //    which contains information about the selected slides, on the add-in's page.

    var firstSlideId = 0;

    function gotoSelectedSlide() {
        //Get currently selected slide's id
        Office.context.document.getSelectedDataAsync(Office.CoercionType.SlideRange, function (asyncResult) {
            if (asyncResult.status == "failed") {
                app.showNotification("Action failed with error: " + asyncResult.error.message);
            }
            else {
                firstSlideId = asyncResult.value.slides[0].id;
                app.showNotification(JSON.stringify(asyncResult.value));
            }
        });
        //Go to slide by id.
        Office.context.document.goToByIdAsync(firstSlideId, Office.GoToType.Slide, function (asyncResult) {
            if (asyncResult.status == "failed") {
                app.showNotification("Action failed with error: " + asyncResult.error.message);
            }
            else {
                app.showNotification("Navigation successful");
            }
        });
    }


    // Go to slide by index (PowerPoint)

    // The following example shows how to:

    // 1. Specify the index of the first, last, previous, or next slide to go to.

    // 2. Pass an anonymous callback function that returns the status of the operation

    //    to the callback parameter of the goToByIdAsync method.

    // 3. Display the value on the add-in's page.

    function goToSlideByIndex() {
        var goToFirst = Office.Index.First;
        var goToLast = Office.Index.Last;
        var goToPrevious = Office.Index.Previous;
        var goToNext = Office.Index.Next;

        Office.context.document.goToByIdAsync(goToNext, Office.GoToType.Index, function (asyncResult) {
            if (asyncResult.status == "failed") {
                showMessage("Action failed with error: " + asyncResult.error.message);
            }
            else {
                showMessage("Navigation successful");
            }
        });
    }

    ```
  name: goToByIdAsync(id, goToType, options, callback)
  fullName: office.Office.Document.goToByIdAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'goToByIdAsync(id: string | number, goToType: GoToType, options?: GoToByIdOptions, callback?: (result: AsyncResult<any>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: id
      description: <span data-ttu-id="f60c8-564">转到的位置的标识符。</span><span class="sxs-lookup"><span data-stu-id="f60c8-564">The identifier of the object or location to go to.</span></span>
      type:
      - string | number
    - id: goToType
      description: <span data-ttu-id="f60c8-565">转到的位置的类型。</span><span class="sxs-lookup"><span data-stu-id="f60c8-565">The type of the location to go to.</span></span>
      type:
      - office.Office.GoToType
    - id: options
      description: <span data-ttu-id="f60c8-566">提供选项是否选择导航到的位置。</span><span class="sxs-lookup"><span data-stu-id="f60c8-566">Provides options for whether to select the location that is navigated to.</span></span>
      type:
      - office.Office.GoToByIdOptions
    - id: callback
      description: <span data-ttu-id="f60c8-567">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-567">Optional.</span></span> <span data-ttu-id="f60c8-568">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-568">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-569">`value`结果属性是当前视图。</span><span class="sxs-lookup"><span data-stu-id="f60c8-569">The `value` property of the result is the current view.</span></span>
      type:
      - '(result: AsyncResult<any>) => void'
- uid: office.Office.Document.mode
  summary: <span data-ttu-id="f60c8-570">获取文档所处的模式。</span><span class="sxs-lookup"><span data-stu-id="f60c8-570">Gets the mode the document is in.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-571\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-571\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p159\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此属性。空的单元格表示相应的 Office 主机应用程序不支持此属性。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p159\">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>\n\n<span data-ttu-id=\"f60c8-574\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-574\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-575\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-575\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-576\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-576\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-577\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-577\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-578\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-578\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-579\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-579\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"f60c8-580\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-580\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-581\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-581\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"f60c8-582\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-582\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-583\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-583\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-584\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-584\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-585\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-585\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"f60c8-586\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-586\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-587\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-587\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-588\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-588\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-589\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-589\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-590\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-590\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-591\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-591\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-592\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-592\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-593\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-593\">Examples</span></span>\n\n```javascript\nfunction displayDocumentMode() {\n    write(Office.context.document.mode);\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```\n```javascript\n// The following example initializes the add-in and then gets properties of the\n// Document object that are available in the context of a Project document.\n// A Project document is the opened, active project. To access members of the\n// ProjectDocument object, use the Office.context.document object as shown in\n// the code examples for ProjectDocument methods and events.\n// The example assumes your add-in has a reference to the jQuery library and\n// that the following page control is defined in the content div in the page body:\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n\n            // Get information about the document.\n            showDocumentProperties();\n        });\n    };\n\n    // Get the document mode and the URL of the active project.\n    function showDocumentProperties() {\n        var output = String.format(\n            'The document mode is {0}.<br/>The URL of the active project is {1}.',\n            Office.context.document.mode,\n            Office.context.document.url);\n        $('#message').html(output);\n    }\n})();\n```"
  name: mode
  fullName: office.Office.Document.mode
  langs:
  - typeScript
  type: property
  syntax:
    content: 'mode: DocumentMode;'
    return:
      type:
      - office.Office.DocumentMode
- uid: office.Office.Document.removeHandlerAsync
  summary: <span data-ttu-id="f60c8-594">移除指定的事件类型的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="f60c8-594">Removes an event handler for the specified event type.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="f60c8-595">要求集</span><span class="sxs-lookup"><span data-stu-id="f60c8-595">Requirement Sets</span></span></td><td><span data-ttu-id="f60c8-596">DocumentEvents</span><span class="sxs-lookup"><span data-stu-id="f60c8-596">DocumentEvents</span></span></td></tr></table>


    <span data-ttu-id="f60c8-597">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-597">**Support details**</span></span>


    <span data-ttu-id="f60c8-p160">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p160">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-600">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-600">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-601">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-601">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-602">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-602">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-603">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-603">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="f60c8-604">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="f60c8-604">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="f60c8-605"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-605"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="f60c8-606">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-606">Y</span></span> </td><td> <span data-ttu-id="f60c8-607">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-607">Y</span></span> </td><td> <span data-ttu-id="f60c8-608">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-608">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-609"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-609"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="f60c8-610">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-610">Y</span></span> </td><td> <span data-ttu-id="f60c8-611">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-611">Y</span></span> </td><td> <span data-ttu-id="f60c8-612">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-612">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-613"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-613"><strong> Word </strong></span></span></td><td> <span data-ttu-id="f60c8-614">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-614">Y</span></span> </td><td> <span data-ttu-id="f60c8-615">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-615">Y</span></span> </td><td> <span data-ttu-id="f60c8-616">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-616">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-617">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-617">Examples</span></span>


    ```javascript

    // The following example removes the event handler named 'MyHandler'.

    function removeSelectionChangedEventHandler() {
        Office.context.document.removeHandlerAsync(Office.EventType.DocumentSelectionChanged, {handler:MyHandler});
    }


    function MyHandler(eventArgs) {
        doSomethingWithDocument(eventArgs.document);
    }

    ```

    ```javascript

    // The following code example uses addHandlerAsync to add an event handler for the

    // ResourceSelectionChanged event and removeHandlerAsync to remove the handler.

    // When a resource is selected in a resource view, the handler displays the

    // resource GUID. When the handler is removed, the GUID is not displayed.

    // The example assumes that your add-in has a reference to the jQuery library and

    // that the following page control is defined in the content div in the page body:

    // <input id="remove-handler" type="button" value="Remove handler" /><br />

    // <span id="message"></span>


    (function () {
        "use strict";

        // The initialize function must be run each time a new page is loaded.
        Office.initialize = function (reason) {
            $(document).ready(function () {

                // After the DOM is loaded, add-in-specific code can run.
                Office.context.document.addHandlerAsync(
                    Office.EventType.ResourceSelectionChanged,
                    getResourceGuid);
                $('#remove-handler').click(removeEventHandler);
            });
        };

        // Remove the event handler.
        function removeEventHandler() {
            Office.context.document.removeHandlerAsync(
                Office.EventType.ResourceSelectionChanged,
                {handler:getResourceGuid,
                asyncContext:'The handler is removed.'},
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        $('#remove-handler').attr('disabled', 'disabled');
                        $('#message').html(result.asyncContext);
                    }
                }
            );
        }

        // Get the GUID of the currently selected resource and display it in the add-in.
        function getResourceGuid() {
            Office.context.document.getSelectedResourceAsync(
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        $('#message').html('Resource GUID: ' + result.value);
                    }
                }
            );
        }

        function onError(error) {
            $('#message').html(error.name + ' ' + error.code + ': ' + error.message);
        }
    })();

    ```
  name: removeHandlerAsync(eventType, options, callback)
  fullName: office.Office.Document.removeHandlerAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'removeHandlerAsync(eventType: Office.EventType, options?: RemoveHandlerOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: <span data-ttu-id="f60c8-618">事件类型。</span><span class="sxs-lookup"><span data-stu-id="f60c8-618">The event type.</span></span> <span data-ttu-id="f60c8-619">对于文档可以是 Document.SelectionChanged 或 Document.ActiveViewChanged。</span><span class="sxs-lookup"><span data-stu-id="f60c8-619">For document can be 'Document.SelectionChanged' or 'Document.ActiveViewChanged'.</span></span>
      type:
      - Office.EventType
    - id: options
      description: <span data-ttu-id="f60c8-620">提供选项以确定哪些事件处理程序或处理程序将删除。</span><span class="sxs-lookup"><span data-stu-id="f60c8-620">Provides options to determine which event handler or handlers are removed.</span></span>
      type:
      - office.Office.RemoveHandlerOptions
    - id: callback
      description: <span data-ttu-id="f60c8-621">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-621">Optional.</span></span> <span data-ttu-id="f60c8-622">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-622">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Document.setResourceFieldAsync
  summary: >-
    <span data-ttu-id="f60c8-623">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-623">Project documents only.</span></span> <span data-ttu-id="f60c8-624">设置资源域的指定资源 id。</span><span class="sxs-lookup"><span data-stu-id="f60c8-624">Set resource field for specified resource Id.</span></span>


    <span data-ttu-id="f60c8-625">重要说明：此 API 仅可在 Windows 桌面上的 Project 2016 中运行。</span><span class="sxs-lookup"><span data-stu-id="f60c8-625">Important: This API works only in Project 2016 on Windows desktop.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-626">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-626">**Support details**</span></span>


    <span data-ttu-id="f60c8-p164">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p164">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="f60c8-629">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-629">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-630">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-630">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-631">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-631">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-632">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-632">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id="f60c8-633"><strong>项目</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-633"><strong> Project </strong></span></span></td><td> <span data-ttu-id="f60c8-634">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-634">Y</span></span> </td><td> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="f60c8-635">示例</span><span class="sxs-lookup"><span data-stu-id="f60c8-635">Examples</span></span>


    ```javascript

    // The following code example calls getSelectedResourceAsync to get the GUID of the resource that's

    // currently selected in a resource view. Then it sets two resource field values by calling

    // setResourceFieldAsync recursively.

    // The getSelectedTaskAsync method used in the example requires that a task view

    // (for example, Task Usage) is the active view and that a task is selected. See the addHandlerAsync

    // method for an example that activates a button based on the active view type.

    // The example assumes your add-in has a reference to the jQuery library and that the

    // following page controls are defined in the content div in the page body:

    // <input id="set-info" type="button" value="Set info" /><br />

    // <span id="message"></span>


    (function () {
        "use strict";

        // The initialize function must be run each time a new page is loaded.
        Office.initialize = function (reason) {
            $(document).ready(function () {

                // After the DOM is loaded, add-in-specific code can run.
                app.initialize();
                $('#set-info').click(setResourceInfo);
            });
        };

        // Get the GUID of the resource, and then get the resource fields.
        function setResourceInfo() {
            getResourceGuid().then(
                function (data) {
                    setResourceFields(data);
                }
            );
        }

        // Get the GUID of the selected resource.
        function getResourceGuid() {
            var defer = $.Deferred();
            Office.context.document.getSelectedResourceAsync(
                function (result) {
                    if (result.status === Office.AsyncResultStatus.Failed) {
                        onError(result.error);
                    }
                    else {
                        defer.resolve(result.value);
                    }
                }
            );
            return defer.promise();
        }

        // Set the specified fields for the selected resource.
        function setResourceFields(resourceGuid) {
            var targetFields = [Office.ProjectResourceFields.StandardRate, Office.ProjectResourceFields.Notes];
            var fieldValues = [.28, 'Notes for the resource.'];

            // Set the field value. If the call is successful, set the next field.
            for (var i = 0; i < targetFields.length; i++) {
                Office.context.document.setResourceFieldAsync(
                    resourceGuid,
                    targetFields[i],
                    fieldValues[i],
                    function (result) {
                        if (result.status === Office.AsyncResultStatus.Succeeded) {
                            i++;
                        }
                        else {
                            onError(result.error);
                        }
                    }
                );
            }
            $('#message').html('Field values set');
        }

        function onError(error) {
            app.showNotification(error.name + ' ' + error.code + ': ' + error.message);
        }
    })();

    ```
  name: setResourceFieldAsync(resourceId, fieldId, fieldValue, options, callback)
  fullName: office.Office.Document.setResourceFieldAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setResourceFieldAsync(resourceId: string, fieldId: number, fieldValue: string | number | boolean | object, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: resourceId
      description: <span data-ttu-id="f60c8-636">字符串或资源 id 值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-636">Either a string or value of the Resource Id.</span></span>
      type:
      - string
    - id: fieldId
      description: <span data-ttu-id="f60c8-637">资源字段。</span><span class="sxs-lookup"><span data-stu-id="f60c8-637">Resource Fields.</span></span>
      type:
      - number
    - id: fieldValue
      description: <span data-ttu-id="f60c8-638">目标字段值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-638">Value of the target field.</span></span>
      type:
      - string | number | boolean | object
    - id: options
      description: <span data-ttu-id="f60c8-639">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-639">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-640">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-640">Optional.</span></span> <span data-ttu-id="f60c8-641">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-641">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Document.setSelectedDataAsync
  summary: <span data-ttu-id="f60c8-642">当前选定内容中写入指定的数据。</span><span class="sxs-lookup"><span data-stu-id="f60c8-642">Writes the specified data into the current selection.</span></span>
  remarks: "<table><tr><td><span data-ttu-id=\"f60c8-643\">要求集</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-643\">Requirement Sets</span></span></td><td><span data-ttu-id=\"f60c8-644\">Selection</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-644\">Selection</span></span></td></tr></table>\n\n<span data-ttu-id=\"f60c8-645\">**特定于应用程序的行为**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-645\">**Application-specific behaviors**</span></span>\n\n<span data-ttu-id=\"f60c8-646\">以下特定于应用程序的操作应用到选定内容中写入数据时。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-646\">The following application-specific actions apply when writing data to a selection.</span></span>\n\n<table> <tr><td><span data-ttu-id=\"f60c8-647\">Word</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-647\">Word</span></span></td><td><span data-ttu-id=\"f60c8-648\">如果不存在选择且插入点位于一个有效的位置，指定`data`在插入点插入</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-648\">If there is no selection and the insertion point is at a valid location, the specified `data` is inserted at the insertion point</span></span></td><td><span data-ttu-id=\"f60c8-649\">如果`data`是一个字符串，则插入指定的文本。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-649\">If `data` is a string, the specified text is inserted.</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-650\">如果`data`是数组的数组 （\"矩阵\"） 或 TableData 对象，新的 Word 表中插入。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-650\">If `data` is an array of arrays (\"matrix\") or a TableData object, a new Word table is inserted.</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-651\">如果`data`是 HTML，则插入指定的 HTML。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-651\">If `data` is HTML, the specified HTML is inserted.</span></span> <span data-ttu-id=\"f60c8-652\">(重要： 如果的任何 HTML 插入无效，Word 不会引发错误。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-652\">(Important: If any of the HTML you insert is invalid, Word won't raise an error.</span></span> <span data-ttu-id=\"f60c8-653\">Word 将插入尽可能多的 html，它可以并忽略任何无效的数据）。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-653\">Word will insert as much of the HTML as it can and omits any invalid data).</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-654\">如果`data`是 Office Open XML，插入指定的 XML。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-654\">If `data` is Office Open XML, the specified XML is inserted.</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-655\">如果`data`是 base64 编码的图像流、 插入指定的图像。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-655\">If `data` is a base64 encoded image stream, the specified image is inserted.</span></span></td></tr></td></tr> <tr><td></td><td><span data-ttu-id=\"f60c8-656\">如果选定内容</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-656\">If there is a selection</span></span></td><td><span data-ttu-id=\"f60c8-657\">将替换它具有指定`data`遵循规则与上述相同。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-657\">It will be replaced with the specified `data` following the same rules as above.</span></span></td></tr> <tr><td></td><td><span data-ttu-id=\"f60c8-658\">插入图像</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-658\">Insert images</span></span></td><td><span data-ttu-id=\"f60c8-659\">插入的图像位于内嵌。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-659\">Inserted images are placed inline.</span></span> <span data-ttu-id=\"f60c8-660\">ImageLeft 和 imageTop 参数将被忽略。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-660\">The imageLeft and imageTop parameters are ignored.</span></span> <span data-ttu-id=\"f60c8-661\">图像的纵横比始终被锁定。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-661\">The image aspect ratio is always locked.</span></span> <span data-ttu-id=\"f60c8-662\">如果只给定 imageWidth 参数或只给定 imageHeight 参数，则另一个值将自动扩展以保留原始纵横比。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-662\">If only one of the imageWidth and imageHeight parameter is given, the other value will be automatically scaled to keep the original aspect ratio.</span></span></td></tr>\n\n<tr><td><span data-ttu-id=\"f60c8-663\">Excel</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-663\">Excel</span></span></td><td><span data-ttu-id=\"f60c8-664\">如果选中的单个单元格</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-664\">If a single cell is selected</span></span></td><td><span data-ttu-id=\"f60c8-665\">如果`data`是一个字符串，指定的文本将作为当前单元格的值插入。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-665\">If `data` is a string, the specified text is inserted as the value of the current cell.</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-666\">如果`data`是数组的数组 （\"矩阵\"） 指定的行集和插入列，如果会不覆盖周围单元格中的任何其他数据。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-666\">If `data` is an array of arrays (\"matrix\"), the specified set of rows and columns are inserted, if no other data in surrounding cells will be overwritten.</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-667\">如果`data`是 TableData 对象，具有一组指定的行的新 Excel 表并插入标头，如果会不覆盖周围单元格中的任何其他数据。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-667\">If `data` is a TableData object, a new Excel table with the specified set of rows and headers is inserted, if no other data in surrounding cells will be overwritten.</span></span></td></tr> <tr><td></td><td><span data-ttu-id=\"f60c8-668\">如果选择了多个单元格</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-668\">If multiple cells are selected</span></span></td><td><span data-ttu-id=\"f60c8-669\">如果形状不匹配的形状`data`，则返回一个错误。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-669\">If the shape does not match the shape of `data`, an error is returned.</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-670\">如果所选内容的形状完全匹配的形状`data`，所选单元格的值更新中的值基于`data`。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-670\">If the shape of the selection exactly matches the shape of `data`, the values of the selected cells are updated based on the values in `data`.</span></span></td></tr> <tr><td></td><td><span data-ttu-id=\"f60c8-671\">插入图像</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-671\">Insert images</span></span></td><td><span data-ttu-id=\"f60c8-672\">插入的图像为浮动图像。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-672\">Inserted images are floating.</span></span> <span data-ttu-id=\"f60c8-673\">imageLeft 和 imageTop 位置参数是相对于当前选定的单元格而言的。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-673\">The position imageLeft and imageTop parameters are relative to currently selected cell(s).</span></span> <span data-ttu-id=\"f60c8-674\">允许 imageLeft 和 imageTop 的值为负数，将由 Excel 重新调整在工作表内放置的图像位置。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-674\">Negative imageLeft and imageTop values are allowed and possibly readjusted by Excel to position the image inside a worksheet.</span></span> <span data-ttu-id=\"f60c8-675\">除非 imageWidth 和 imageHeight 参数均已提供，否则将锁定图像的纵横比。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-675\">Image aspect ratio is locked unless both imageWidth and imageHeight parameters are provided.</span></span> <span data-ttu-id=\"f60c8-676\">如果只给定 imageWidth 参数或只给定 imageHeight 参数，则另一个值将自动扩展以保留原始纵横比。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-676\">If only one of the imageWidth and imageHeight parameter is given, the other value will be automatically scaled to keep the original aspect ratio.</span></span></td></tr> <tr><td></td><td><span data-ttu-id=\"f60c8-677\">其他所有情况下</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-677\">All other cases</span></span></td><td><span data-ttu-id=\"f60c8-678\">将返回错误。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-678\">An error is returned.</span></span></td></tr>\n\n<tr><td><span data-ttu-id=\"f60c8-679\">Excel Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-679\">Excel Online</span></span></td><td><span data-ttu-id=\"f60c8-680\">除了 for Excel 上面所述的行为，这些限制适用时在 Excel Online 中写入数据</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-680\">In addition to the behaviors described for Excel above, these limits apply when writing data in Excel Online</span></span></td><td><span data-ttu-id=\"f60c8-681\">您可以写入与工作表的单元格的总数目`data`参数不能超过 20000 中单个调用此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-681\">The total number of cells you can write to a worksheet with the `data` parameter can't exceed 20,000 in a single call to this method.</span></span></td></tr> <tr><td></td><td></td><td><span data-ttu-id=\"f60c8-682\">格式的组的数目传递给`cellFormat`参数不能超过 100。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-682\">The number of formatting groups passed to the `cellFormat` parameter can't exceed 100.</span></span> <span data-ttu-id=\"f60c8-683\">单个格式组包括一组应用于特定单元格范围的格式。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-683\">A single formatting group consists of a set of formatting applied to a specified range of cells.</span></span></td></tr>\n\n<tr><td><span data-ttu-id=\"f60c8-684\">PowerPoint</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-684\">PowerPoint</span></span></td><td><span data-ttu-id=\"f60c8-685\">插入图像</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-685\">Insert image</span></span></td><td><span data-ttu-id=\"f60c8-686\">插入的图像为浮动图像。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-686\">Inserted images are floating.</span></span> <span data-ttu-id=\"f60c8-687\">在位置 imageLeft 和 imageTop 参数是可选的但如果提供，应同时存在。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-687\">The position imageLeft and imageTop parameters are optional but if provided, both should be present.</span></span> <span data-ttu-id=\"f60c8-688\">如果提供单个值，则它将被忽略。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-688\">If a single value is provided, it will be ignored.</span></span> <span data-ttu-id=\"f60c8-689\">允许 imageLeft 和 imageTop 的值为负数，且可以将图像放置在幻灯片的外部。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-689\">Negative imageLeft and imageTop values are allowed and can position an image outside of a slide.</span></span> <span data-ttu-id=\"f60c8-690\">如果未给定任何可选参数，并且幻灯片有一个占位符，则图像将替换幻灯片中的占位符。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-690\">If no optional parameter is given and slide has a placeholder, the image will replace the placeholder in the slide.</span></span> <span data-ttu-id=\"f60c8-691\">除非 imageWidth和 imageHeight 参数均已提供，否则将锁定图像纵横比。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-691\">Image aspect ratio will be locked unless both imageWidth and imageHeight parameters are provided.</span></span> <span data-ttu-id=\"f60c8-692\">如果只给定 imageWidth 参数或只给定 imageHeight 参数，则另一个值将自动扩展以保留原始纵横比。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-692\">If only one of the imageWidth and imageHeight parameter is given, the other value will be automatically scaled to keep the original aspect ratio.</span></span></td></tr> </table>\n\n<span data-ttu-id=\"f60c8-693\">[Office.CoercionType](xref:office.Office.CoercionType)参数的可能值随主机。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-693\">The possible values for the [Office.CoercionType](xref:office.Office.CoercionType) parameter vary by the host.</span></span>\n\n<table> <tr> <th><span data-ttu-id=\"f60c8-694\">Host</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-694\">Host</span></span></th> <th><span data-ttu-id=\"f60c8-695\">支持的 coercionType</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-695\">Supported coercionType</span></span></th> </tr> <tr> <td><span data-ttu-id=\"f60c8-696\">Excel、 联机 Excel、 PowerPoint、 联机 PowerPoint、 Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-696\">Excel, Excel Online, PowerPoint, PowerPoint Online, Word, and Word Online</span></span></td> <td><span data-ttu-id=\"f60c8-697\">`Office.CoercionType.Text`（字符串）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-697\">`Office.CoercionType.Text` (string)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-698\">Excel、 Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-698\">Excel, Word, and Word Online</span></span></td> <td><span data-ttu-id=\"f60c8-699\">`Office.CoercionType.Matrix`（数组的数组）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-699\">`Office.CoercionType.Matrix` (array of arrays)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-700\">Access、 Excel、 Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-700\">Access, Excel, Word, and Word Online</span></span></td> <td><span data-ttu-id=\"f60c8-701\">`Office.CoercionType.Table`（TableData 对象）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-701\">`Office.CoercionType.Table` (TableData object)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-702\">Word</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-702\">Word</span></span></td> <td>`Office.CoercionType.Html`</td> </tr> <tr> <td><span data-ttu-id=\"f60c8-703\">Word 和 Word Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-703\">Word and Word Online</span></span> </td> <td><span data-ttu-id=\"f60c8-704\">`Office.CoercionType.Ooxml`(Office Open XML)</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-704\">`Office.CoercionType.Ooxml` (Office Open XML)</span></span></td> </tr> <tr> <td><span data-ttu-id=\"f60c8-705\">PowerPoint 和 PowerPoint Online</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-705\">PowerPoint and PowerPoint Online</span></span></td> <td>`Office.CoercionType.SlideRange`</td> </tr> </table>\n\n<span data-ttu-id=\"f60c8-706\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-706\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p171\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p171\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-709\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-709\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-710\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-710\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-711\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-711\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-712\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-712\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-713\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-713\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-714\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-714\"><strong> Access </strong></span></span></td><td> <span data-ttu-id=\"f60c8-715\">y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-715\">y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-716\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-716\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"f60c8-717\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-717\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-718\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-718\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-719\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-719\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-720\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-720\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"f60c8-721\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-721\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-722\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-722\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-723\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-723\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-724\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-724\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-725\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-725\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-726\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-726\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-727\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-727\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-728\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-728\">Examples</span></span>\n\n```javascript\n// The following example sets the selected text or cell to \"Hello World!\", \n// and if that fails, displays the value of the error.message property.\nfunction writeText() {\n    Office.context.document.setSelectedDataAsync(\"Hello World!\",\n        function (asyncResult) {\n            var error = asyncResult.error;\n            if (asyncResult.status === Office.AsyncResultStatus.Failed){\n                write(error.name + \": \" + error.message);\n            }\n        });\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n\n// Specifying the optional coercionType parameter lets you specify the kind of data you want to write\n// to a selection. The following example writes data as an array of three rows of two columns, \n// specifying the coercionType as \"matrix\" for that data structure, and if that fails, \n// displays the value of the error.message property.\nfunction writeMatrix() {\n    Office.context.document.setSelectedDataAsync(\n        [[\"Red\", \"Rojo\"], [\"Green\", \"Verde\"], [\"Blue\", \"Azul\"]],\n        {coercionType: Office.CoercionType.Matrix}\n        function (asyncResult) {\n            var error = asyncResult.error;\n            if (asyncResult.status === Office.AsyncResultStatus.Failed){\n                write(error.name + \": \" + error.message);\n            }\n        });\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n\n// The following example writes data as a one column table with a header and four rows, \n// specifying the coercionType as \"table\" for that data structure, and if that fails, \n// displays the value of the error.message property.\nfunction writeTable() {\n    // Build table.\n    var myTable = new Office.TableData();\n    myTable.headers = [[\"Cities\"]];\n    myTable.rows = [['Berlin'], ['Roma'], ['Tokyo'], ['Seattle']];\n\n    // Write table.\n    Office.context.document.setSelectedDataAsync(myTable, {coercionType: Office.CoercionType.Table},\n        function (result) {\n            var error = result.error\n            if (result.status === Office.AsyncResultStatus.Failed) {\n                write(error.name + \": \" + error.message);\n            }\n    });\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n\n// In Word if you want to write HTML to the selection, you can specify the coercionType parameter as \"html\"\n// as shown in the following example, which uses HTML <b> tags to make \"Hello\" bold.\nfunction writeHtmlData() {\n    Office.context.document.setSelectedDataAsync(\n        \"<b>Hello</b> World!\", {coercionType: Office.CoercionType.Html}, function (asyncResult) {\n            if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n                write('Error: ' + asyncResult.error.message);\n            }\n    });\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n\n// In Word, PowerPoint, or Excel, if you want to write an image to the selection, you can specify the coercionType\n// parameter as \"image\" as shown in the following example. Note that imageLeft and imageTop are ignored by Word.\nfunction insertPictureAtSelection(base64EncodedImageStr) {\n\n    Office.context.document.setSelectedDataAsync(base64EncodedImageStr, {\n    coercionType: Office.CoercionType.Image,\n    imageLeft: 50,\n    imageTop: 50,\n    imageWidth: 100,\n    imageHeight: 100\n    },\n    function (asyncResult) {\n        if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n            console.log(\"Action failed with error: \" + asyncResult.error.message);\n        }\n    });\n}\n```"
  name: setSelectedDataAsync(data, options, callback)
  fullName: office.Office.Document.setSelectedDataAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setSelectedDataAsync(data: string | TableData | any[][], options?: SetSelectedDataOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: >-
        <span data-ttu-id="f60c8-729">要设置的数据。</span><span class="sxs-lookup"><span data-stu-id="f60c8-729">The data to be set.</span></span> <span data-ttu-id="f60c8-730">接受字符串或[Office.CoercionType](xref:office.Office.CoercionType)值、 二维数组或 TableData 对象。</span><span class="sxs-lookup"><span data-stu-id="f60c8-730">Either a string or[Office.CoercionType](xref:office.Office.CoercionType) value, 2d array or TableData object.</span></span>


        <span data-ttu-id="f60c8-731">如果值传递的`data`是：</span><span class="sxs-lookup"><span data-stu-id="f60c8-731">If the value passed for `data` is:</span></span>


        - <span data-ttu-id="f60c8-732">一个字符串：将插入可以强制为 string 的纯文本或任何文本。</span><span class="sxs-lookup"><span data-stu-id="f60c8-732">A string: Plain text or anything that can be coerced to a string will be inserted.</span></span> <span data-ttu-id="f60c8-733">在 Excel 中，还可以将 data 指定为有效公式，将该公式添加到选定的单元格。</span><span class="sxs-lookup"><span data-stu-id="f60c8-733">In Excel, you can also specify data as a valid formula to add that formula to the selected cell.</span></span> <span data-ttu-id="f60c8-734">例如，设置为"= SUM(A1:A5)"的数据将总指定范围中的值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-734">For example, setting data to "=SUM(A1:A5)" will total the values in the specified range.</span></span> <span data-ttu-id="f60c8-735">但是，当你在绑定单元格中设置公式时，设置后将无法从绑定单元格读取添加的公式（或任何已有公式）。</span><span class="sxs-lookup"><span data-stu-id="f60c8-735">However, when you set a formula on the bound cell, after doing so, you can't read the added formula (or any pre-existing formula) from the bound cell.</span></span> <span data-ttu-id="f60c8-736">如果你在选定的单元格上调用 Document.getSelectedDataAsync 方法以读取其数据，方法可能仅返回在单元格中显示的数据（即公式的结果）。</span><span class="sxs-lookup"><span data-stu-id="f60c8-736">If you call the Document.getSelectedDataAsync method on the selected cell to read its data, the method can return only the data displayed in the cell (the formula's result).</span></span>


        - <span data-ttu-id="f60c8-737">数组的数组（“矩阵”）：将插入不带标题的表数据。</span><span class="sxs-lookup"><span data-stu-id="f60c8-737">An array of arrays ("matrix"): Tabular data without headers will be inserted.</span></span> <span data-ttu-id="f60c8-738">例如，将数据写入三行两列中，可以传递类似如下的数组： \[ \["R1C1"、"R1C2"\]， \["R2C1"、"R2C2"\]， \["R3C1"、"R3C2"\]\]。</span><span class="sxs-lookup"><span data-stu-id="f60c8-738">For example, to write data to three rows in two columns, you can pass an array like this: \[\["R1C1", "R1C2"\], \["R2C1", "R2C2"\], \["R3C1", "R3C2"\]\].</span></span> <span data-ttu-id="f60c8-739">若要写入一列的三行，传递类似如下的数组： \[ \["R1C1"\]， \["R2C1"\]， \["R3C1"\]\]</span><span class="sxs-lookup"><span data-stu-id="f60c8-739">To write a single column of three rows, pass an array like this: \[\["R1C1"\], \["R2C1"\], \["R3C1"\]\]</span></span>


        <span data-ttu-id="f60c8-740">在 Excel 中，还可以将 data 指定为数组的数组，其中包含有效公式以将其添加到选定单元格。</span><span class="sxs-lookup"><span data-stu-id="f60c8-740">In Excel, you can also specify data as an array of arrays that contains valid formulas to add them to the selected cells.</span></span> <span data-ttu-id="f60c8-741">例如，如果没有其他数据将被覆盖，将数据设置为\[ \["= SUM(A1:A5)","=AVERAGE(A1:A5)"\] \]将添加到选定内容的这些两个公式。</span><span class="sxs-lookup"><span data-stu-id="f60c8-741">For example if no other data will be overwritten, setting data to \[\["=SUM(A1:A5)","=AVERAGE(A1:A5)"\]\] will add those two formulas to the selection.</span></span> <span data-ttu-id="f60c8-742">与在单个单元格上将公式设置为“text”一样，设置后你将无法读取添加的公式（或任何已有公式），只能读取公式的结果。</span><span class="sxs-lookup"><span data-stu-id="f60c8-742">Just as when setting a formula on a single cell as "text", you can't read the added formulas (or any pre-existing formulas) after they have been set - you can only read the formulas' results.</span></span>


        - <span data-ttu-id="f60c8-743">TableData 对象：将插入带标题的表格。</span><span class="sxs-lookup"><span data-stu-id="f60c8-743">A TableData object: A table with headers will be inserted.</span></span> <span data-ttu-id="f60c8-744">在 Excel 中，如果您指定的 data 形参，传递 TableData 对象中的公式您可能无法获得由于 Excel 自动复制公式的列内的"计算的列"功能预期的结果。</span><span class="sxs-lookup"><span data-stu-id="f60c8-744">In Excel, if you specify formulas in the TableData object you pass for the data parameter, you might not get the results you expect due to the "calculated columns" feature of Excel, which automatically duplicates formulas within a column.</span></span> <span data-ttu-id="f60c8-745">若要变通解决此问题时要编写`data`，其中包含所选表格公式、 尝试指定数据作为数组的数组 （而不是 TableData 对象），并指定的 coercionType 为 Microsoft.Office.Matrix 或"matrix"。</span><span class="sxs-lookup"><span data-stu-id="f60c8-745">To work around this when you want to write `data` that contains formulas to a selected table, try specifying the data as an array of arrays (instead of a TableData object), and specify the coercionType as Microsoft.Office.Matrix or "matrix".</span></span>
      type:
      - string | TableData | any[][]
    - id: options
      description: <span data-ttu-id="f60c8-746">提供了有关如何向所选内容插入数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-746">Provides options for how to insert data to the selection.</span></span>
      type:
      - office.Office.SetSelectedDataOptions
    - id: callback
      description: <span data-ttu-id="f60c8-747">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-747">Optional.</span></span> <span data-ttu-id="f60c8-748">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-748">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span> <span data-ttu-id="f60c8-749">AsyncResult.value 属性始终返回 undefined，因为没有要检索数据或对象。</span><span class="sxs-lookup"><span data-stu-id="f60c8-749">The AsyncResult.value property always returns undefined because there is no object or data to retrieve.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Document.setTaskFieldAsync
  summary: >-
    <span data-ttu-id="f60c8-750">仅项目文档。</span><span class="sxs-lookup"><span data-stu-id="f60c8-750">Project documents only.</span></span> <span data-ttu-id="f60c8-751">设置任务域的指定任务 id。</span><span class="sxs-lookup"><span data-stu-id="f60c8-751">Set task field for specified task Id.</span></span>


    <span data-ttu-id="f60c8-752">重要说明：此 API 仅可在 Windows 桌面上的 Project 2016 中运行。</span><span class="sxs-lookup"><span data-stu-id="f60c8-752">Important: This API works only in Project 2016 on Windows desktop.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-753\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-753\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p179\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此方法。空的单元格表示相应的 Office 主机应用程序不支持此方法。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p179\">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>\n\n<span data-ttu-id=\"f60c8-756\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-756\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-757\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-757\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-758\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-758\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-759\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-759\">Office Online (in browser)</span></span></th></tr> <tr><td><span data-ttu-id=\"f60c8-760\"><strong>项目</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-760\"><strong> Project </strong></span></span></td><td> <span data-ttu-id=\"f60c8-761\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-761\">Y</span></span> </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-762\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-762\">Examples</span></span>\n\n```javascript\n// The following code example calls getSelectedTaskAsync to get the GUID of the task that's\n// currently selected in a task view. Then it sets two task field values by calling\n// setTaskFieldAsync recursively.\n// The getSelectedTaskAsync method used in the example requires that a task view\n// (for example, Task Usage) is the active view and that a task is selected. See the\n// addHandlerAsync method for an example that activates a button based on the active view type.\n// The example assumes your add-in has a reference to the jQuery library and that the\n// following page controls are defined in the content div in the page body:\n// <input id=\"set-info\" type=\"button\" value=\"Set info\" /><br />\n// <span id=\"message\"></span>\n\n(function () {\n    \"use strict\";\n\n    // The initialize function must be run each time a new page is loaded.\n    Office.initialize = function (reason) {\n        $(document).ready(function () {\n            \n            // After the DOM is loaded, add-in-specific code can run.\n            app.initialize();\n            $('#set-info').click(setTaskInfo);\n        });\n    };\n\n    // Get the GUID of the task, and then get the task fields.\n    function setTaskInfo() {\n        getTaskGuid().then(\n            function (data) {\n                setTaskFields(data);\n            }\n        );\n    }\n\n    // Get the GUID of the selected task.\n    function getTaskGuid() {\n        var defer = $.Deferred();\n        Office.context.document.getSelectedTaskAsync(\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    onError(result.error);\n                }\n                else {\n                    defer.resolve(result.value);\n                }\n            }\n        );\n        return defer.promise();\n    }\n\n    // Set the specified fields for the selected task.\n    function setTaskFields(taskGuid) {\n        var targetFields = [Office.ProjectTaskFields.Active, Office.ProjectTaskFields.Notes];\n        var fieldValues = [true, 'Notes for the task.'];\n\n        // Set the field value. If the call is successful, set the next field.\n        for (var i = 0; i < targetFields.length; i++) {\n            Office.context.document.setTaskFieldAsync(\n                taskGuid,\n                targetFields[i],\n                fieldValues[i],\n                function (result) {\n                    if (result.status === Office.AsyncResultStatus.Succeeded) {\n                        i++;\n                    }\n                    else {\n                        onError(result.error);\n                    }\n                }\n            );\n        }\n        $('#message').html('Field values set');\n    }\n\n    function onError(error) {\n        app.showNotification(error.name + ' ' + error.code + ': ' + error.message);\n    }\n})();\n```"
  name: setTaskFieldAsync(taskId, fieldId, fieldValue, options, callback)
  fullName: office.Office.Document.setTaskFieldAsync
  langs:
  - typeScript
  type: method
  syntax:
    content: 'setTaskFieldAsync(taskId: string, fieldId: number, fieldValue: string | number | boolean | object, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: taskId
      description: <span data-ttu-id="f60c8-763">字符串或任务 id 值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-763">Either a string or value of the Task Id.</span></span>
      type:
      - string
    - id: fieldId
      description: <span data-ttu-id="f60c8-764">任务域。</span><span class="sxs-lookup"><span data-stu-id="f60c8-764">Task Fields.</span></span>
      type:
      - number
    - id: fieldValue
      description: <span data-ttu-id="f60c8-765">目标字段值。</span><span class="sxs-lookup"><span data-stu-id="f60c8-765">Value of the target field.</span></span>
      type:
      - string | number | boolean | object
    - id: options
      description: <span data-ttu-id="f60c8-766">提供用于保留不变，用于在回调中的任何类型的上下文数据的选项。</span><span class="sxs-lookup"><span data-stu-id="f60c8-766">Provides an option for preserving context data of any type, unchanged, for use in a callback.</span></span>
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: <span data-ttu-id="f60c8-767">可选。</span><span class="sxs-lookup"><span data-stu-id="f60c8-767">Optional.</span></span> <span data-ttu-id="f60c8-768">在回调返回时调用的其唯一参数的类型[Office.AsyncResult](xref:office.Office.AsyncResult)函数<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-768">A function that is invoked when the callback returns, whose only parameter is of type[Office.AsyncResult](xref:office.Office.AsyncResult)<!-- -->.</span></span>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Document.settings
  summary: <span data-ttu-id="f60c8-769">获取用于表示当前文档的内容或任务窗格应用程序的已保存自定义设置的对象。</span><span class="sxs-lookup"><span data-stu-id="f60c8-769">Gets an object that represents the saved custom settings of the content or task pane add-in for the current document.</span></span>
  remarks: >-
    <span data-ttu-id="f60c8-770">**支持详细信息**</span><span class="sxs-lookup"><span data-stu-id="f60c8-770">**Support details**</span></span>


    <span data-ttu-id="f60c8-p181">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此属性。空的单元格表示相应的 Office 主机应用程序不支持此属性。</span><span class="sxs-lookup"><span data-stu-id="f60c8-p181">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>


    <span data-ttu-id="f60c8-773">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class="sxs-lookup"><span data-stu-id="f60c8-773">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="f60c8-774">*支持的主机（按平台）*</span><span class="sxs-lookup"><span data-stu-id="f60c8-774">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="f60c8-775">Office for Windows Desktop</span><span class="sxs-lookup"><span data-stu-id="f60c8-775">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="f60c8-776">Office Online（在浏览器中）</span><span class="sxs-lookup"><span data-stu-id="f60c8-776">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="f60c8-777">Office for iPad</span><span class="sxs-lookup"><span data-stu-id="f60c8-777">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="f60c8-778"><strong>访问</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-778"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id="f60c8-779">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-779">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id="f60c8-780"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-780"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="f60c8-781">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-781">Y</span></span> </td><td> <span data-ttu-id="f60c8-782">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-782">Y</span></span> </td><td> <span data-ttu-id="f60c8-783">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-783">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-784"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-784"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="f60c8-785">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-785">Y</span></span> </td><td> <span data-ttu-id="f60c8-786">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-786">Y</span></span> </td><td> <span data-ttu-id="f60c8-787">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-787">Y</span></span> </td></tr> <tr><td><span data-ttu-id="f60c8-788"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="f60c8-788"><strong> Word </strong></span></span></td><td> <span data-ttu-id="f60c8-789">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-789">Y</span></span> </td><td> <span data-ttu-id="f60c8-790">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-790">Y</span></span> </td><td> <span data-ttu-id="f60c8-791">Y</span><span class="sxs-lookup"><span data-stu-id="f60c8-791">Y</span></span> </td></tr> </table>
  name: settings
  fullName: office.Office.Document.settings
  langs:
  - typeScript
  type: property
  syntax:
    content: 'settings: Settings;'
    return:
      type:
      - office.Office.Settings
- uid: office.Office.Document.url
  summary: <span data-ttu-id="f60c8-792">获取主机应用程序当前打开的文档的 URL。</span><span class="sxs-lookup"><span data-stu-id="f60c8-792">Gets the URL of the document that the host application currently has open.</span></span> <span data-ttu-id="f60c8-793">如果 URL 不可，返回 null。</span><span class="sxs-lookup"><span data-stu-id="f60c8-793">Returns null if the URL is unavailable.</span></span>
  remarks: "<span data-ttu-id=\"f60c8-794\">**支持详细信息**</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-794\">**Support details**</span></span>\n\n<span data-ttu-id=\"f60c8-p183\">下列矩阵中的大写字母 Y 表示相应的 Office 主机应用程序支持此属性。空的单元格表示相应的 Office 主机应用程序不支持此属性。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-p183\">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>\n\n<span data-ttu-id=\"f60c8-797\">有关 Office 主机应用程序和服务器要求的详细信息，请参阅[Requirements for Office 加载项运行](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->。</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-797\">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>\n\n<span data-ttu-id=\"f60c8-798\">*支持的主机（按平台）*</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-798\">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id=\"f60c8-799\">Office for Windows Desktop</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-799\">Office for Windows desktop</span></span> </th><th> <span data-ttu-id=\"f60c8-800\">Office Online（在浏览器中）</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-800\">Office Online (in browser)</span></span> </th><th> <span data-ttu-id=\"f60c8-801\">Office for iPad</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-801\">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id=\"f60c8-802\"><strong>访问</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-802\"><strong> Access </strong></span></span></td><td> </td><td> <span data-ttu-id=\"f60c8-803\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-803\">Y</span></span> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-804\"><strong>Excel</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-804\"><strong> Excel </strong></span></span></td><td> <span data-ttu-id=\"f60c8-805\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-805\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-806\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-806\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-807\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-807\">Y</span></span> </td></tr> <tr><td><span data-ttu-id=\"f60c8-808\"><strong>PowerPoint</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-808\"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id=\"f60c8-809\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-809\">Y</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id=\"f60c8-810\"><strong>Word</strong></span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-810\"><strong> Word </strong></span></span></td><td> <span data-ttu-id=\"f60c8-811\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-811\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-812\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-812\">Y</span></span> </td><td> <span data-ttu-id=\"f60c8-813\">Y</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-813\">Y</span></span> </td></tr> </table>\n#### <a name=\"examples\"></a><span data-ttu-id=\"f60c8-814\">示例</span><span class=\"sxs-lookup\"><span data-stu-id=\"f60c8-814\">Examples</span></span>\n\n```javascript\nfunction displayDocumentUrl() {\n    write(Office.context.document.url);\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: url
  fullName: office.Office.Document.url
  langs:
  - typeScript
  type: property
  syntax:
    content: 'url: string;'
    return:
      type:
      - string
